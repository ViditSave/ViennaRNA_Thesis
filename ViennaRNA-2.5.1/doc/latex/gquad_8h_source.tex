\hypertarget{gquad_8h_source}{}\doxysection{gquad.\+h}
\label{gquad_8h_source}\index{ViennaRNA/gquad.h@{ViennaRNA/gquad.h}}
\mbox{\hyperlink{gquad_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef VIENNA\_RNA\_PACKAGE\_GQUAD\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define VIENNA\_RNA\_PACKAGE\_GQUAD\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{datastructures_2basic_8h}{ViennaRNA/datastructures/basic.h}}>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{fold__compound_8h}{ViennaRNA/fold\_compound.h}}>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{params_2basic_8h}{ViennaRNA/params/basic.h}}>}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#ifndef INLINE}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\# define INLINE inline}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\# define INLINE}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15 }
\DoxyCodeLine{30 \textcolor{keywordtype}{int}         E\_gquad(\textcolor{keywordtype}{int}           L,}
\DoxyCodeLine{31                     \textcolor{keywordtype}{int}           l[3],}
\DoxyCodeLine{32                     \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P);}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}  exp\_E\_gquad(\textcolor{keywordtype}{int}               L,}
\DoxyCodeLine{36                         \textcolor{keywordtype}{int}               l[3],}
\DoxyCodeLine{37                         \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}  *pf);}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{keywordtype}{void} E\_gquad\_ali\_en(\textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{41                     \textcolor{keywordtype}{int}           L,}
\DoxyCodeLine{42                     \textcolor{keywordtype}{int}           l[3],}
\DoxyCodeLine{43                     \textcolor{keyword}{const} \textcolor{keywordtype}{short}   **S,}
\DoxyCodeLine{44                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  **a2s,}
\DoxyCodeLine{45                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  n\_seq,}
\DoxyCodeLine{46                     \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P,}
\DoxyCodeLine{47                     \textcolor{keywordtype}{int}           en[2]);}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 }
\DoxyCodeLine{66 \textcolor{keywordtype}{int} *\mbox{\hyperlink{group__gquads_ga2480171f753eed5bf337e283dee16129}{get\_gquad\_matrix}}(\textcolor{keywordtype}{short}         *S,}
\DoxyCodeLine{67                       \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P);}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{keywordtype}{int} *get\_gquad\_ali\_matrix(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  n,}
\DoxyCodeLine{71                           \textcolor{keywordtype}{short}         *S\_cons,}
\DoxyCodeLine{72                           \textcolor{keywordtype}{short}         **S,}
\DoxyCodeLine{73                           \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  **a2s,}
\DoxyCodeLine{74                           \textcolor{keywordtype}{int}           n\_seq,}
\DoxyCodeLine{75                           \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P);}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 }
\DoxyCodeLine{78 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}} *get\_gquad\_pf\_matrix(\textcolor{keywordtype}{short}             *S,}
\DoxyCodeLine{79                                 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}        *scale,}
\DoxyCodeLine{80                                 \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}  *pf);}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}} *get\_gquad\_pf\_matrix\_comparative(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  n,}
\DoxyCodeLine{84                                             \textcolor{keywordtype}{short}             *S\_cons,}
\DoxyCodeLine{85                                             \textcolor{keywordtype}{short}             **S,}
\DoxyCodeLine{86                                             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}      **a2s,}
\DoxyCodeLine{87                                             \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}        *scale,}
\DoxyCodeLine{88                                             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}      n\_seq,}
\DoxyCodeLine{89                                             \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}  *pf);}
\DoxyCodeLine{90 }
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{keywordtype}{int} **get\_gquad\_L\_matrix(\textcolor{keywordtype}{short}        *S,}
\DoxyCodeLine{93                          \textcolor{keywordtype}{int}          start,}
\DoxyCodeLine{94                          \textcolor{keywordtype}{int}          maxdist,}
\DoxyCodeLine{95                          \textcolor{keywordtype}{int}          n,}
\DoxyCodeLine{96                          \textcolor{keywordtype}{int}          **g,}
\DoxyCodeLine{97                          \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P);}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{keywordtype}{void}        vrna\_gquad\_mx\_local\_update(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}} *vc,}
\DoxyCodeLine{101                                        \textcolor{keywordtype}{int}                  start);}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 }
\DoxyCodeLine{104 \textcolor{keywordtype}{void} get\_gquad\_pattern\_mfe(\textcolor{keywordtype}{short}        *S,}
\DoxyCodeLine{105                            \textcolor{keywordtype}{int}          i,}
\DoxyCodeLine{106                            \textcolor{keywordtype}{int}          j,}
\DoxyCodeLine{107                            \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P,}
\DoxyCodeLine{108                            \textcolor{keywordtype}{int}          *L,}
\DoxyCodeLine{109                            \textcolor{keywordtype}{int}          l[3]);}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 }
\DoxyCodeLine{112 \textcolor{keywordtype}{void}}
\DoxyCodeLine{113 get\_gquad\_pattern\_exhaustive(\textcolor{keywordtype}{short}        *S,}
\DoxyCodeLine{114                              \textcolor{keywordtype}{int}          i,}
\DoxyCodeLine{115                              \textcolor{keywordtype}{int}          j,}
\DoxyCodeLine{116                              \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P,}
\DoxyCodeLine{117                              \textcolor{keywordtype}{int}          *L,}
\DoxyCodeLine{118                              \textcolor{keywordtype}{int}          *l,}
\DoxyCodeLine{119                              \textcolor{keywordtype}{int}          threshold);}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 }
\DoxyCodeLine{122 \textcolor{keywordtype}{void} get\_gquad\_pattern\_pf(\textcolor{keywordtype}{short}             *S,}
\DoxyCodeLine{123                           \textcolor{keywordtype}{int}               i,}
\DoxyCodeLine{124                           \textcolor{keywordtype}{int}               j,}
\DoxyCodeLine{125                           \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}  *pf,}
\DoxyCodeLine{126                           \textcolor{keywordtype}{int}               *L,}
\DoxyCodeLine{127                           \textcolor{keywordtype}{int}               l[3]);}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 }
\DoxyCodeLine{130 \mbox{\hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist}} *get\_plist\_gquad\_from\_pr(\textcolor{keywordtype}{short}            *S,}
\DoxyCodeLine{131                                \textcolor{keywordtype}{int}              gi,}
\DoxyCodeLine{132                                \textcolor{keywordtype}{int}              gj,}
\DoxyCodeLine{133                                \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}       *G,}
\DoxyCodeLine{134                                \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}       *probs,}
\DoxyCodeLine{135                                \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}       *scale,}
\DoxyCodeLine{136                                \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}} *pf);}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \mbox{\hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist}} *get\_plist\_gquad\_from\_pr\_max(\textcolor{keywordtype}{short}            *S,}
\DoxyCodeLine{140                                    \textcolor{keywordtype}{int}              gi,}
\DoxyCodeLine{141                                    \textcolor{keywordtype}{int}              gj,}
\DoxyCodeLine{142                                    \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}       *G,}
\DoxyCodeLine{143                                    \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}       *probs,}
\DoxyCodeLine{144                                    \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}       *scale,}
\DoxyCodeLine{145                                    \textcolor{keywordtype}{int}              *L,}
\DoxyCodeLine{146                                    \textcolor{keywordtype}{int}              l[3],}
\DoxyCodeLine{147                                    \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}} *pf);}
\DoxyCodeLine{148 }
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \mbox{\hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist}} *get\_plist\_gquad\_from\_db(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure,}
\DoxyCodeLine{151                                \textcolor{keywordtype}{float}      \mbox{\hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr}});}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \mbox{\hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist}} *}
\DoxyCodeLine{155 vrna\_get\_plist\_gquad\_from\_pr(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}} *fc,}
\DoxyCodeLine{156                              \textcolor{keywordtype}{int}                  gi,}
\DoxyCodeLine{157                              \textcolor{keywordtype}{int}                  gj);}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \mbox{\hyperlink{group__struct__utils__plist_structvrna__elem__prob__s}{plist}} *}
\DoxyCodeLine{161 vrna\_get\_plist\_gquad\_from\_pr\_max(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}} *fc,}
\DoxyCodeLine{162                                  \textcolor{keywordtype}{int}                  gi,}
\DoxyCodeLine{163                                  \textcolor{keywordtype}{int}                  gj,}
\DoxyCodeLine{164                                  \textcolor{keywordtype}{int}                  *Lmax,}
\DoxyCodeLine{165                                  \textcolor{keywordtype}{int}                  lmax[3]);}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{keywordtype}{int}         get\_gquad\_count(\textcolor{keywordtype}{short} *S,}
\DoxyCodeLine{169                             \textcolor{keywordtype}{int}   i,}
\DoxyCodeLine{170                             \textcolor{keywordtype}{int}   j);}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \textcolor{keywordtype}{int}         get\_gquad\_layer\_count(\textcolor{keywordtype}{short} *S,}
\DoxyCodeLine{174                                   \textcolor{keywordtype}{int}   i,}
\DoxyCodeLine{175                                   \textcolor{keywordtype}{int}   j);}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \textcolor{keywordtype}{void} get\_gquad\_pattern\_mfe\_ali(\textcolor{keywordtype}{short}        **S,}
\DoxyCodeLine{179                                \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} **a2s,}
\DoxyCodeLine{180                                \textcolor{keywordtype}{short}        *S\_cons,}
\DoxyCodeLine{181                                \textcolor{keywordtype}{int}          n\_seq,}
\DoxyCodeLine{182                                \textcolor{keywordtype}{int}          i,}
\DoxyCodeLine{183                                \textcolor{keywordtype}{int}          j,}
\DoxyCodeLine{184                                \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P,}
\DoxyCodeLine{185                                \textcolor{keywordtype}{int}          *L,}
\DoxyCodeLine{186                                \textcolor{keywordtype}{int}          l[3]);}
\DoxyCodeLine{187 }
\DoxyCodeLine{188 }
\DoxyCodeLine{199 \textcolor{keywordtype}{int} \mbox{\hyperlink{group__gquads_gae41763215b9c64d2a7b67f0df8a28078}{parse\_gquad}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}  *struc,}
\DoxyCodeLine{200                 \textcolor{keywordtype}{int}         *L,}
\DoxyCodeLine{201                 \textcolor{keywordtype}{int}         l[3]);}
\DoxyCodeLine{202 }
\DoxyCodeLine{203 }
\DoxyCodeLine{204 INLINE PRIVATE \textcolor{keywordtype}{int} \mbox{\hyperlink{group__gquads_ga220c41e8dbcee940ac975b8ce88e55c5}{backtrack\_GQuad\_IntLoop}}(\textcolor{keywordtype}{int}          c,}
\DoxyCodeLine{205                                            \textcolor{keywordtype}{int}          i,}
\DoxyCodeLine{206                                            \textcolor{keywordtype}{int}          j,}
\DoxyCodeLine{207                                            \textcolor{keywordtype}{int}          type,}
\DoxyCodeLine{208                                            \textcolor{keywordtype}{short}        *S,}
\DoxyCodeLine{209                                            \textcolor{keywordtype}{int}          *ggg,}
\DoxyCodeLine{210                                            \textcolor{keywordtype}{int}          *index,}
\DoxyCodeLine{211                                            \textcolor{keywordtype}{int}          *p,}
\DoxyCodeLine{212                                            \textcolor{keywordtype}{int}          *q,}
\DoxyCodeLine{213                                            \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P);}
\DoxyCodeLine{214 }
\DoxyCodeLine{215 }
\DoxyCodeLine{216 INLINE PRIVATE \textcolor{keywordtype}{int} backtrack\_GQuad\_IntLoop\_comparative(\textcolor{keywordtype}{int}          c,}
\DoxyCodeLine{217                                                        \textcolor{keywordtype}{int}          i,}
\DoxyCodeLine{218                                                        \textcolor{keywordtype}{int}          j,}
\DoxyCodeLine{219                                                        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *type,}
\DoxyCodeLine{220                                                        \textcolor{keywordtype}{short}        *S\_cons,}
\DoxyCodeLine{221                                                        \textcolor{keywordtype}{short}        **S5,}
\DoxyCodeLine{222                                                        \textcolor{keywordtype}{short}        **S3,}
\DoxyCodeLine{223                                                        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} **a2s,}
\DoxyCodeLine{224                                                        \textcolor{keywordtype}{int}          *ggg,}
\DoxyCodeLine{225                                                        \textcolor{keywordtype}{int}          *index,}
\DoxyCodeLine{226                                                        \textcolor{keywordtype}{int}          *p,}
\DoxyCodeLine{227                                                        \textcolor{keywordtype}{int}          *q,}
\DoxyCodeLine{228                                                        \textcolor{keywordtype}{int}          n\_seq,}
\DoxyCodeLine{229                                                        \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P);}
\DoxyCodeLine{230 }
\DoxyCodeLine{231 }
\DoxyCodeLine{232 INLINE PRIVATE \textcolor{keywordtype}{int} \mbox{\hyperlink{group__gquads_ga7b371308fa5a45c7ac353ef6ed1014de}{backtrack\_GQuad\_IntLoop\_L}}(\textcolor{keywordtype}{int}          c,}
\DoxyCodeLine{233                                              \textcolor{keywordtype}{int}          i,}
\DoxyCodeLine{234                                              \textcolor{keywordtype}{int}          j,}
\DoxyCodeLine{235                                              \textcolor{keywordtype}{int}          type,}
\DoxyCodeLine{236                                              \textcolor{keywordtype}{short}        *S,}
\DoxyCodeLine{237                                              \textcolor{keywordtype}{int}          **ggg,}
\DoxyCodeLine{238                                              \textcolor{keywordtype}{int}          maxdist,}
\DoxyCodeLine{239                                              \textcolor{keywordtype}{int}          *p,}
\DoxyCodeLine{240                                              \textcolor{keywordtype}{int}          *q,}
\DoxyCodeLine{241                                              \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P);}
\DoxyCodeLine{242 }
\DoxyCodeLine{243 }
\DoxyCodeLine{244 PRIVATE INLINE \textcolor{keywordtype}{int}}
\DoxyCodeLine{245 vrna\_BT\_gquad\_int(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *vc,}
\DoxyCodeLine{246                   \textcolor{keywordtype}{int}                   i,}
\DoxyCodeLine{247                   \textcolor{keywordtype}{int}                   j,}
\DoxyCodeLine{248                   \textcolor{keywordtype}{int}                   en,}
\DoxyCodeLine{249                   \mbox{\hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}}       *bp\_stack,}
\DoxyCodeLine{250                   \textcolor{keywordtype}{int}                   *stack\_count);}
\DoxyCodeLine{251 }
\DoxyCodeLine{252 }
\DoxyCodeLine{253 PRIVATE INLINE \textcolor{keywordtype}{int}}
\DoxyCodeLine{254 vrna\_BT\_gquad\_mfe(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *vc,}
\DoxyCodeLine{255                   \textcolor{keywordtype}{int}                   i,}
\DoxyCodeLine{256                   \textcolor{keywordtype}{int}                   j,}
\DoxyCodeLine{257                   \mbox{\hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}}       *bp\_stack,}
\DoxyCodeLine{258                   \textcolor{keywordtype}{int}                   *stack\_count)}
\DoxyCodeLine{259 \{}
\DoxyCodeLine{260   \textcolor{comment}{/*}}
\DoxyCodeLine{261 \textcolor{comment}{   * here we do some fancy stuff to backtrace the stacksize and linker lengths}}
\DoxyCodeLine{262 \textcolor{comment}{   * of the g-\/quadruplex that should reside within position i,j}}
\DoxyCodeLine{263 \textcolor{comment}{   */}}
\DoxyCodeLine{264   \textcolor{keywordtype}{short}         *S;}
\DoxyCodeLine{265   \textcolor{keywordtype}{int}           l[3], L, a, n\_seq;}
\DoxyCodeLine{266   \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P;}
\DoxyCodeLine{267 }
\DoxyCodeLine{268   \textcolor{keywordflow}{if} (vc) \{}
\DoxyCodeLine{269     P = vc-\/>\mbox{\hyperlink{group__fold__compound_a19b8720c2c5321c1b97c830bd17566ea}{params}};}
\DoxyCodeLine{270     \textcolor{keywordflow}{switch} (vc-\/>\mbox{\hyperlink{group__fold__compound_a391bcf8ac5997784aaf780cdd251c464}{type}}) \{}
\DoxyCodeLine{271       \textcolor{keywordflow}{case} \mbox{\hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6}{VRNA\_FC\_TYPE\_SINGLE}}:}
\DoxyCodeLine{272         S = vc-\/>sequence\_encoding2;}
\DoxyCodeLine{273         L = -\/1;}
\DoxyCodeLine{274 }
\DoxyCodeLine{275         get\_gquad\_pattern\_mfe(S, i, j, P, \&L, l);}
\DoxyCodeLine{276         \textcolor{keywordflow}{break};}
\DoxyCodeLine{277 }
\DoxyCodeLine{278       \textcolor{keywordflow}{case} \mbox{\hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023}{VRNA\_FC\_TYPE\_COMPARATIVE}}:}
\DoxyCodeLine{279         n\_seq = vc-\/>\mbox{\hyperlink{group__fold__compound_a614702ab74478e786272be44f8cebfe3}{n\_seq}};}
\DoxyCodeLine{280         L     = -\/1;}
\DoxyCodeLine{281         get\_gquad\_pattern\_mfe\_ali(vc-\/>\mbox{\hyperlink{group__fold__compound_aebb37297f92c7bd22aac6343f8f61d61}{S}}, vc-\/>a2s, vc-\/>\mbox{\hyperlink{group__fold__compound_aa3fab7ae38ebfed2028375221d295686}{S\_cons}}, n\_seq, i, j, P, \&L, l);}
\DoxyCodeLine{282         \textcolor{keywordflow}{break};}
\DoxyCodeLine{283     \}}
\DoxyCodeLine{284 }
\DoxyCodeLine{285     \textcolor{keywordflow}{if} (L != -\/1) \{}
\DoxyCodeLine{286       \textcolor{comment}{/* fill the G's of the quadruplex into base\_pair2 */}}
\DoxyCodeLine{287       \textcolor{keywordflow}{for} (a = 0; a < L; a++) \{}
\DoxyCodeLine{288         bp\_stack[++(*stack\_count)].i  = i + a;}
\DoxyCodeLine{289         bp\_stack[(*stack\_count)].j    = i + a;}
\DoxyCodeLine{290         bp\_stack[++(*stack\_count)].i  = i + L + l[0] + a;}
\DoxyCodeLine{291         bp\_stack[(*stack\_count)].j    = i + L + l[0] + a;}
\DoxyCodeLine{292         bp\_stack[++(*stack\_count)].i  = i + L + l[0] + L + l[1] + a;}
\DoxyCodeLine{293         bp\_stack[(*stack\_count)].j    = i + L + l[0] + L + l[1] + a;}
\DoxyCodeLine{294         bp\_stack[++(*stack\_count)].i  = i + L + l[0] + L + l[1] + L + l[2] + a;}
\DoxyCodeLine{295         bp\_stack[(*stack\_count)].j    = i + L + l[0] + L + l[1] + L + l[2] + a;}
\DoxyCodeLine{296       \}}
\DoxyCodeLine{297       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{298     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{299       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{300     \}}
\DoxyCodeLine{301   \}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{304 \}}
\DoxyCodeLine{305 }
\DoxyCodeLine{306 }
\DoxyCodeLine{307 PRIVATE INLINE \textcolor{keywordtype}{int}}
\DoxyCodeLine{308 vrna\_BT\_gquad\_int(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *vc,}
\DoxyCodeLine{309                   \textcolor{keywordtype}{int}                   i,}
\DoxyCodeLine{310                   \textcolor{keywordtype}{int}                   j,}
\DoxyCodeLine{311                   \textcolor{keywordtype}{int}                   en,}
\DoxyCodeLine{312                   \mbox{\hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}}       *bp\_stack,}
\DoxyCodeLine{313                   \textcolor{keywordtype}{int}                   *stack\_count)}
\DoxyCodeLine{314 \{}
\DoxyCodeLine{315   \textcolor{keywordtype}{int}           energy, \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}, *idx, ij, p, q, maxl, minl, c0, l1, *ggg;}
\DoxyCodeLine{316   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} type;}
\DoxyCodeLine{317   \textcolor{keywordtype}{char}          *ptype;}
\DoxyCodeLine{318   \textcolor{keywordtype}{short}         si, sj, *S, *S1;}
\DoxyCodeLine{319 }
\DoxyCodeLine{320   \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P;}
\DoxyCodeLine{321   \mbox{\hyperlink{group__model__details_structvrna__md__s}{vrna\_md\_t}}     *md;}
\DoxyCodeLine{322 }
\DoxyCodeLine{323   idx     = vc-\/>\mbox{\hyperlink{group__fold__compound_a5037235dee512efd85ca543780bbca1a}{jindx}};}
\DoxyCodeLine{324   ij      = idx[j] + i;}
\DoxyCodeLine{325   P       = vc-\/>\mbox{\hyperlink{group__fold__compound_a19b8720c2c5321c1b97c830bd17566ea}{params}};}
\DoxyCodeLine{326   md      = \&(P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}});}
\DoxyCodeLine{327   ptype   = vc-\/>\mbox{\hyperlink{group__fold__compound_a3fbea559f1d1976b2d67c215cdeee0b2}{ptype}};}
\DoxyCodeLine{328   type    = (\textcolor{keywordtype}{unsigned} char)ptype[ij];}
\DoxyCodeLine{329   S1      = vc-\/>\mbox{\hyperlink{group__fold__compound_a9934bdb695d35a3544285cbcc19f9763}{sequence\_encoding}};}
\DoxyCodeLine{330   S       = vc-\/>sequence\_encoding2;}
\DoxyCodeLine{331   \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} = md-\/>\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{332   si      = S1[i + 1];}
\DoxyCodeLine{333   sj      = S1[j -\/ 1];}
\DoxyCodeLine{334   ggg     = vc-\/>\mbox{\hyperlink{group__fold__compound_aca8be7bdc65bafe2172c6ee777f18568}{matrices}}-\/>\mbox{\hyperlink{group__dp__matrices_a0b7b86a5c75c96eabb89eb53a13e7164}{ggg}};}
\DoxyCodeLine{335   energy  = 0;}
\DoxyCodeLine{336 }
\DoxyCodeLine{337   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} == 2)}
\DoxyCodeLine{338     energy += P-\/>mismatchI[type][si][sj];}
\DoxyCodeLine{339 }
\DoxyCodeLine{340   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{341     energy += P-\/>TerminalAU;}
\DoxyCodeLine{342 }
\DoxyCodeLine{343   p = i + 1;}
\DoxyCodeLine{344   \textcolor{keywordflow}{if} (S1[p] == 3) \{}
\DoxyCodeLine{345     \textcolor{keywordflow}{if} (p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{346       minl  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{347       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{348       minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{349       c0    = j -\/ 3;}
\DoxyCodeLine{350       maxl  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{351       maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{352       \textcolor{keywordflow}{for} (q = minl; q < maxl; q++) \{}
\DoxyCodeLine{353         \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{354           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{355 }
\DoxyCodeLine{356         \textcolor{keywordflow}{if} (en == energy + ggg[idx[q] + p] + P-\/>internal\_loop[j -\/ q -\/ 1])}
\DoxyCodeLine{357           \textcolor{keywordflow}{return} vrna\_BT\_gquad\_mfe(vc, p, q, bp\_stack, stack\_count);}
\DoxyCodeLine{358       \}}
\DoxyCodeLine{359     \}}
\DoxyCodeLine{360   \}}
\DoxyCodeLine{361 }
\DoxyCodeLine{362   \textcolor{keywordflow}{for} (p = i + 2;}
\DoxyCodeLine{363        p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{364        p++) \{}
\DoxyCodeLine{365     l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{366     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{367       \textcolor{keywordflow}{break};}
\DoxyCodeLine{368 }
\DoxyCodeLine{369     \textcolor{keywordflow}{if} (S1[p] != 3)}
\DoxyCodeLine{370       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{371 }
\DoxyCodeLine{372     minl  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{373     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{374     minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{375     c0    = j -\/ 1;}
\DoxyCodeLine{376     maxl  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{377     maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{378     \textcolor{keywordflow}{for} (q = minl; q < maxl; q++) \{}
\DoxyCodeLine{379       \textcolor{keywordflow}{if} (S1[q] != 3)}
\DoxyCodeLine{380         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{381 }
\DoxyCodeLine{382       \textcolor{keywordflow}{if} (en == energy + ggg[idx[q] + p] + P-\/>internal\_loop[l1 + j -\/ q -\/ 1])}
\DoxyCodeLine{383         \textcolor{keywordflow}{return} vrna\_BT\_gquad\_mfe(vc, p, q, bp\_stack, stack\_count);}
\DoxyCodeLine{384     \}}
\DoxyCodeLine{385   \}}
\DoxyCodeLine{386 }
\DoxyCodeLine{387   q = j -\/ 1;}
\DoxyCodeLine{388   \textcolor{keywordflow}{if} (S1[q] == 3)}
\DoxyCodeLine{389     \textcolor{keywordflow}{for} (p = i + 4;}
\DoxyCodeLine{390          p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{391          p++) \{}
\DoxyCodeLine{392       l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{393       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{394         \textcolor{keywordflow}{break};}
\DoxyCodeLine{395 }
\DoxyCodeLine{396       \textcolor{keywordflow}{if} (S1[p] != 3)}
\DoxyCodeLine{397         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{398 }
\DoxyCodeLine{399       \textcolor{keywordflow}{if} (en == energy + ggg[idx[q] + p] + P-\/>internal\_loop[l1])}
\DoxyCodeLine{400         \textcolor{keywordflow}{return} vrna\_BT\_gquad\_mfe(vc, p, q, bp\_stack, stack\_count);}
\DoxyCodeLine{401     \}}
\DoxyCodeLine{402 }
\DoxyCodeLine{403   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{404 \}}
\DoxyCodeLine{405 }
\DoxyCodeLine{406 }
\DoxyCodeLine{424 INLINE PRIVATE \textcolor{keywordtype}{int}}
\DoxyCodeLine{425 \mbox{\hyperlink{group__gquads_ga220c41e8dbcee940ac975b8ce88e55c5}{backtrack\_GQuad\_IntLoop}}(\textcolor{keywordtype}{int}           c,}
\DoxyCodeLine{426                         \textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{427                         \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{428                         \textcolor{keywordtype}{int}           type,}
\DoxyCodeLine{429                         \textcolor{keywordtype}{short}         *S,}
\DoxyCodeLine{430                         \textcolor{keywordtype}{int}           *ggg,}
\DoxyCodeLine{431                         \textcolor{keywordtype}{int}           *index,}
\DoxyCodeLine{432                         \textcolor{keywordtype}{int}           *p,}
\DoxyCodeLine{433                         \textcolor{keywordtype}{int}           *q,}
\DoxyCodeLine{434                         \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{435 \{}
\DoxyCodeLine{436   \textcolor{keywordtype}{int}   energy, \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}, k, l, maxl, minl, c0, l1;}
\DoxyCodeLine{437   \textcolor{keywordtype}{short} si, sj;}
\DoxyCodeLine{438 }
\DoxyCodeLine{439   \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} = P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{440   si      = S[i + 1];}
\DoxyCodeLine{441   sj      = S[j -\/ 1];}
\DoxyCodeLine{442   energy  = 0;}
\DoxyCodeLine{443 }
\DoxyCodeLine{444   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} == 2)}
\DoxyCodeLine{445     energy += P-\/>mismatchI[type][si][sj];}
\DoxyCodeLine{446 }
\DoxyCodeLine{447   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{448     energy += P-\/>TerminalAU;}
\DoxyCodeLine{449 }
\DoxyCodeLine{450   k = i + 1;}
\DoxyCodeLine{451   \textcolor{keywordflow}{if} (S[k] == 3) \{}
\DoxyCodeLine{452     \textcolor{keywordflow}{if} (k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{453       minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{454       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{455       minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{456       c0    = j -\/ 3;}
\DoxyCodeLine{457       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{458       maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{459       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{460         \textcolor{keywordflow}{if} (S[l] != 3)}
\DoxyCodeLine{461           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{462 }
\DoxyCodeLine{463         \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + P-\/>internal\_loop[j -\/ l -\/ 1]) \{}
\DoxyCodeLine{464           *p  = k;}
\DoxyCodeLine{465           *q  = l;}
\DoxyCodeLine{466           \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{467         \}}
\DoxyCodeLine{468       \}}
\DoxyCodeLine{469     \}}
\DoxyCodeLine{470   \}}
\DoxyCodeLine{471 }
\DoxyCodeLine{472   \textcolor{keywordflow}{for} (k = i + 2;}
\DoxyCodeLine{473        k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{474        k++) \{}
\DoxyCodeLine{475     l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{476     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{477       \textcolor{keywordflow}{break};}
\DoxyCodeLine{478 }
\DoxyCodeLine{479     \textcolor{keywordflow}{if} (S[k] != 3)}
\DoxyCodeLine{480       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{481 }
\DoxyCodeLine{482     minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{483     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{484     minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{485     c0    = j -\/ 1;}
\DoxyCodeLine{486     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{487     maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{488     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{489       \textcolor{keywordflow}{if} (S[l] != 3)}
\DoxyCodeLine{490         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{491 }
\DoxyCodeLine{492       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + P-\/>internal\_loop[l1 + j -\/ l -\/ 1]) \{}
\DoxyCodeLine{493         *p  = k;}
\DoxyCodeLine{494         *q  = l;}
\DoxyCodeLine{495         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{496       \}}
\DoxyCodeLine{497     \}}
\DoxyCodeLine{498   \}}
\DoxyCodeLine{499 }
\DoxyCodeLine{500   l = j -\/ 1;}
\DoxyCodeLine{501   \textcolor{keywordflow}{if} (S[l] == 3)}
\DoxyCodeLine{502     \textcolor{keywordflow}{for} (k = i + 4;}
\DoxyCodeLine{503          k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{504          k++) \{}
\DoxyCodeLine{505       l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{506       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{507         \textcolor{keywordflow}{break};}
\DoxyCodeLine{508 }
\DoxyCodeLine{509       \textcolor{keywordflow}{if} (S[k] != 3)}
\DoxyCodeLine{510         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{511 }
\DoxyCodeLine{512       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + P-\/>internal\_loop[l1]) \{}
\DoxyCodeLine{513         *p  = k;}
\DoxyCodeLine{514         *q  = l;}
\DoxyCodeLine{515         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{516       \}}
\DoxyCodeLine{517     \}}
\DoxyCodeLine{518 }
\DoxyCodeLine{519   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{520 \}}
\DoxyCodeLine{521 }
\DoxyCodeLine{522 }
\DoxyCodeLine{523 INLINE PRIVATE \textcolor{keywordtype}{int}}
\DoxyCodeLine{524 backtrack\_GQuad\_IntLoop\_comparative(\textcolor{keywordtype}{int}           c,}
\DoxyCodeLine{525                                     \textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{526                                     \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{527                                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  *type,}
\DoxyCodeLine{528                                     \textcolor{keywordtype}{short}         *S\_cons,}
\DoxyCodeLine{529                                     \textcolor{keywordtype}{short}         **S5,}
\DoxyCodeLine{530                                     \textcolor{keywordtype}{short}         **S3,}
\DoxyCodeLine{531                                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  **a2s,}
\DoxyCodeLine{532                                     \textcolor{keywordtype}{int}           *ggg,}
\DoxyCodeLine{533                                     \textcolor{keywordtype}{int}           *index,}
\DoxyCodeLine{534                                     \textcolor{keywordtype}{int}           *p,}
\DoxyCodeLine{535                                     \textcolor{keywordtype}{int}           *q,}
\DoxyCodeLine{536                                     \textcolor{keywordtype}{int}           n\_seq,}
\DoxyCodeLine{537                                     \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{538 \{}
\DoxyCodeLine{539   \textcolor{keywordtype}{int} energy, \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}, k, l, maxl, minl, c0, l1, ss, tt, u1, u2, eee;}
\DoxyCodeLine{540 }
\DoxyCodeLine{541   \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} = P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{542   energy  = 0;}
\DoxyCodeLine{543 }
\DoxyCodeLine{544   \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{545     tt = type[ss];}
\DoxyCodeLine{546     \textcolor{keywordflow}{if} (tt == 0)}
\DoxyCodeLine{547       tt = 7;}
\DoxyCodeLine{548 }
\DoxyCodeLine{549     \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} == 2)}
\DoxyCodeLine{550       energy += P-\/>mismatchI[tt][S3[ss][i]][S5[ss][j]];}
\DoxyCodeLine{551 }
\DoxyCodeLine{552     \textcolor{keywordflow}{if} (tt > 2)}
\DoxyCodeLine{553       energy += P-\/>TerminalAU;}
\DoxyCodeLine{554   \}}
\DoxyCodeLine{555 }
\DoxyCodeLine{556   k = i + 1;}
\DoxyCodeLine{557   \textcolor{keywordflow}{if} (S\_cons[k] == 3) \{}
\DoxyCodeLine{558     \textcolor{keywordflow}{if} (k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{559       minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{560       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{561       minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{562       c0    = j -\/ 3;}
\DoxyCodeLine{563       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{564       maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{565       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{566         \textcolor{keywordflow}{if} (S\_cons[l] != 3)}
\DoxyCodeLine{567           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{568 }
\DoxyCodeLine{569         eee = 0;}
\DoxyCodeLine{570 }
\DoxyCodeLine{571         \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{572           u1  = a2s[ss][j -\/ 1] -\/ a2s[ss][l];}
\DoxyCodeLine{573           eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{574         \}}
\DoxyCodeLine{575 }
\DoxyCodeLine{576         \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + eee) \{}
\DoxyCodeLine{577           *p  = k;}
\DoxyCodeLine{578           *q  = l;}
\DoxyCodeLine{579           \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{580         \}}
\DoxyCodeLine{581       \}}
\DoxyCodeLine{582     \}}
\DoxyCodeLine{583   \}}
\DoxyCodeLine{584 }
\DoxyCodeLine{585   \textcolor{keywordflow}{for} (k = i + 2;}
\DoxyCodeLine{586        k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{587        k++) \{}
\DoxyCodeLine{588     l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{589     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{590       \textcolor{keywordflow}{break};}
\DoxyCodeLine{591 }
\DoxyCodeLine{592     \textcolor{keywordflow}{if} (S\_cons[k] != 3)}
\DoxyCodeLine{593       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{594 }
\DoxyCodeLine{595     minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{596     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{597     minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{598     c0    = j -\/ 1;}
\DoxyCodeLine{599     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{600     maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{601     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{602       \textcolor{keywordflow}{if} (S\_cons[l] != 3)}
\DoxyCodeLine{603         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{604 }
\DoxyCodeLine{605       eee = 0;}
\DoxyCodeLine{606 }
\DoxyCodeLine{607       \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{608         u1  = a2s[ss][k -\/ 1] -\/ a2s[ss][i];}
\DoxyCodeLine{609         u2  = a2s[ss][j -\/ 1] -\/ a2s[ss][l];}
\DoxyCodeLine{610         eee += P-\/>internal\_loop[u1 + u2];}
\DoxyCodeLine{611       \}}
\DoxyCodeLine{612 }
\DoxyCodeLine{613       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + eee) \{}
\DoxyCodeLine{614         *p  = k;}
\DoxyCodeLine{615         *q  = l;}
\DoxyCodeLine{616         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{617       \}}
\DoxyCodeLine{618     \}}
\DoxyCodeLine{619   \}}
\DoxyCodeLine{620 }
\DoxyCodeLine{621   l = j -\/ 1;}
\DoxyCodeLine{622   \textcolor{keywordflow}{if} (S\_cons[l] == 3)}
\DoxyCodeLine{623     \textcolor{keywordflow}{for} (k = i + 4;}
\DoxyCodeLine{624          k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{625          k++) \{}
\DoxyCodeLine{626       l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{627       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{628         \textcolor{keywordflow}{break};}
\DoxyCodeLine{629 }
\DoxyCodeLine{630       \textcolor{keywordflow}{if} (S\_cons[k] != 3)}
\DoxyCodeLine{631         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{632 }
\DoxyCodeLine{633       eee = 0;}
\DoxyCodeLine{634 }
\DoxyCodeLine{635       \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{636         u1  = a2s[ss][k -\/ 1] -\/ a2s[ss][i];}
\DoxyCodeLine{637         eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{638       \}}
\DoxyCodeLine{639 }
\DoxyCodeLine{640       \textcolor{keywordflow}{if} (c == energy + ggg[index[l] + k] + eee) \{}
\DoxyCodeLine{641         *p  = k;}
\DoxyCodeLine{642         *q  = l;}
\DoxyCodeLine{643         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{644       \}}
\DoxyCodeLine{645     \}}
\DoxyCodeLine{646 }
\DoxyCodeLine{647   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{648 \}}
\DoxyCodeLine{649 }
\DoxyCodeLine{650 }
\DoxyCodeLine{667 INLINE PRIVATE \textcolor{keywordtype}{int}}
\DoxyCodeLine{668 \mbox{\hyperlink{group__gquads_ga7b371308fa5a45c7ac353ef6ed1014de}{backtrack\_GQuad\_IntLoop\_L}}(\textcolor{keywordtype}{int}           c,}
\DoxyCodeLine{669                           \textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{670                           \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{671                           \textcolor{keywordtype}{int}           type,}
\DoxyCodeLine{672                           \textcolor{keywordtype}{short}         *S,}
\DoxyCodeLine{673                           \textcolor{keywordtype}{int}           **ggg,}
\DoxyCodeLine{674                           \textcolor{keywordtype}{int}           maxdist,}
\DoxyCodeLine{675                           \textcolor{keywordtype}{int}           *p,}
\DoxyCodeLine{676                           \textcolor{keywordtype}{int}           *q,}
\DoxyCodeLine{677                           \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{678 \{}
\DoxyCodeLine{679   \textcolor{keywordtype}{int}   energy, \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}, k, l, maxl, minl, c0, l1;}
\DoxyCodeLine{680   \textcolor{keywordtype}{short} si, sj;}
\DoxyCodeLine{681 }
\DoxyCodeLine{682   \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} = P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{683   si      = S[i + 1];}
\DoxyCodeLine{684   sj      = S[j -\/ 1];}
\DoxyCodeLine{685   energy  = 0;}
\DoxyCodeLine{686 }
\DoxyCodeLine{687   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} == 2)}
\DoxyCodeLine{688     energy += P-\/>mismatchI[type][si][sj];}
\DoxyCodeLine{689 }
\DoxyCodeLine{690   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{691     energy += P-\/>TerminalAU;}
\DoxyCodeLine{692 }
\DoxyCodeLine{693   k = i + 1;}
\DoxyCodeLine{694   \textcolor{keywordflow}{if} (S[k] == 3) \{}
\DoxyCodeLine{695     \textcolor{keywordflow}{if} (k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{696       minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{697       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{698       minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{699       c0    = j -\/ 3;}
\DoxyCodeLine{700       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{701       maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{702       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{703         \textcolor{keywordflow}{if} (S[l] != 3)}
\DoxyCodeLine{704           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{705 }
\DoxyCodeLine{706         \textcolor{keywordflow}{if} (c == energy + ggg[k][l -\/ k] + P-\/>internal\_loop[j -\/ l -\/ 1]) \{}
\DoxyCodeLine{707           *p  = k;}
\DoxyCodeLine{708           *q  = l;}
\DoxyCodeLine{709           \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{710         \}}
\DoxyCodeLine{711       \}}
\DoxyCodeLine{712     \}}
\DoxyCodeLine{713   \}}
\DoxyCodeLine{714 }
\DoxyCodeLine{715   \textcolor{keywordflow}{for} (k = i + 2;}
\DoxyCodeLine{716        k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{717        k++) \{}
\DoxyCodeLine{718     l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{719     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{720       \textcolor{keywordflow}{break};}
\DoxyCodeLine{721 }
\DoxyCodeLine{722     \textcolor{keywordflow}{if} (S[k] != 3)}
\DoxyCodeLine{723       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{724 }
\DoxyCodeLine{725     minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{726     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{727     minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{728     c0    = j -\/ 1;}
\DoxyCodeLine{729     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{730     maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{731     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{732       \textcolor{keywordflow}{if} (S[l] != 3)}
\DoxyCodeLine{733         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{734 }
\DoxyCodeLine{735       \textcolor{keywordflow}{if} (c == energy + ggg[k][l -\/ k] + P-\/>internal\_loop[l1 + j -\/ l -\/ 1]) \{}
\DoxyCodeLine{736         *p  = k;}
\DoxyCodeLine{737         *q  = l;}
\DoxyCodeLine{738         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{739       \}}
\DoxyCodeLine{740     \}}
\DoxyCodeLine{741   \}}
\DoxyCodeLine{742 }
\DoxyCodeLine{743   l = j -\/ 1;}
\DoxyCodeLine{744   \textcolor{keywordflow}{if} (S[l] == 3)}
\DoxyCodeLine{745     \textcolor{keywordflow}{for} (k = i + 4;}
\DoxyCodeLine{746          k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{747          k++) \{}
\DoxyCodeLine{748       l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{749       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{750         \textcolor{keywordflow}{break};}
\DoxyCodeLine{751 }
\DoxyCodeLine{752       \textcolor{keywordflow}{if} (S[k] != 3)}
\DoxyCodeLine{753         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{754 }
\DoxyCodeLine{755       \textcolor{keywordflow}{if} (c == energy + ggg[k][l -\/ k] + P-\/>internal\_loop[l1]) \{}
\DoxyCodeLine{756         *p  = k;}
\DoxyCodeLine{757         *q  = l;}
\DoxyCodeLine{758         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{759       \}}
\DoxyCodeLine{760     \}}
\DoxyCodeLine{761 }
\DoxyCodeLine{762   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{763 \}}
\DoxyCodeLine{764 }
\DoxyCodeLine{765 }
\DoxyCodeLine{766 INLINE PRIVATE \textcolor{keywordtype}{int}}
\DoxyCodeLine{767 backtrack\_GQuad\_IntLoop\_L\_comparative(\textcolor{keywordtype}{int}           c,}
\DoxyCodeLine{768                                       \textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{769                                       \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{770                                       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  *type,}
\DoxyCodeLine{771                                       \textcolor{keywordtype}{short}         *S\_cons,}
\DoxyCodeLine{772                                       \textcolor{keywordtype}{short}         **S5,}
\DoxyCodeLine{773                                       \textcolor{keywordtype}{short}         **S3,}
\DoxyCodeLine{774                                       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  **a2s,}
\DoxyCodeLine{775                                       \textcolor{keywordtype}{int}           **ggg,}
\DoxyCodeLine{776                                       \textcolor{keywordtype}{int}           *p,}
\DoxyCodeLine{777                                       \textcolor{keywordtype}{int}           *q,}
\DoxyCodeLine{778                                       \textcolor{keywordtype}{int}           n\_seq,}
\DoxyCodeLine{779                                       \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{780 \{}
\DoxyCodeLine{781   \textcolor{comment}{/*}}
\DoxyCodeLine{782 \textcolor{comment}{   * The case that is handled here actually resembles something like}}
\DoxyCodeLine{783 \textcolor{comment}{   * an interior loop where the enclosing base pair is of regular}}
\DoxyCodeLine{784 \textcolor{comment}{   * kind and the enclosed pair is not a canonical one but a g-\/quadruplex}}
\DoxyCodeLine{785 \textcolor{comment}{   * that should then be decomposed further...}}
\DoxyCodeLine{786 \textcolor{comment}{   */}}
\DoxyCodeLine{787   \textcolor{keywordtype}{int} mm, dangle\_model, k, l, maxl, minl, c0, l1, ss, tt, eee, u1, u2;}
\DoxyCodeLine{788 }
\DoxyCodeLine{789   dangle\_model = P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{790 }
\DoxyCodeLine{791   mm = 0;}
\DoxyCodeLine{792   \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{793     tt = type[ss];}
\DoxyCodeLine{794 }
\DoxyCodeLine{795     \textcolor{keywordflow}{if} (dangle\_model == 2)}
\DoxyCodeLine{796       mm += P-\/>mismatchI[tt][S3[ss][i]][S5[ss][j]];}
\DoxyCodeLine{797 }
\DoxyCodeLine{798     \textcolor{keywordflow}{if} (tt > 2)}
\DoxyCodeLine{799       mm += P-\/>TerminalAU;}
\DoxyCodeLine{800   \}}
\DoxyCodeLine{801 }
\DoxyCodeLine{802   \textcolor{keywordflow}{for} (k = i + 2;}
\DoxyCodeLine{803        k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{804        k++) \{}
\DoxyCodeLine{805     \textcolor{keywordflow}{if} (S\_cons[k] != 3)}
\DoxyCodeLine{806       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{807 }
\DoxyCodeLine{808     l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{809     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{810       \textcolor{keywordflow}{break};}
\DoxyCodeLine{811 }
\DoxyCodeLine{812     minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{813     c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{814     minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{815     c0    = j -\/ 1;}
\DoxyCodeLine{816     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{817     maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{818     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{819       \textcolor{keywordflow}{if} (S\_cons[l] != 3)}
\DoxyCodeLine{820         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{821 }
\DoxyCodeLine{822       eee = 0;}
\DoxyCodeLine{823 }
\DoxyCodeLine{824       \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{825         u1  = a2s[ss][k -\/ 1] -\/ a2s[ss][i];}
\DoxyCodeLine{826         u2  = a2s[ss][j -\/ 1] -\/ a2s[ss][l];}
\DoxyCodeLine{827         eee += P-\/>internal\_loop[u1 + u2];}
\DoxyCodeLine{828       \}}
\DoxyCodeLine{829 }
\DoxyCodeLine{830       c0 = mm +}
\DoxyCodeLine{831            ggg[k][l -\/ k] +}
\DoxyCodeLine{832            eee;}
\DoxyCodeLine{833 }
\DoxyCodeLine{834       \textcolor{keywordflow}{if} (c == c0) \{}
\DoxyCodeLine{835         *p  = k;}
\DoxyCodeLine{836         *q  = l;}
\DoxyCodeLine{837         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{838       \}}
\DoxyCodeLine{839     \}}
\DoxyCodeLine{840   \}}
\DoxyCodeLine{841   k = i + 1;}
\DoxyCodeLine{842   \textcolor{keywordflow}{if} (S\_cons[k] == 3) \{}
\DoxyCodeLine{843     \textcolor{keywordflow}{if} (k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{844       minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{845       c0    = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{846       minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minl);}
\DoxyCodeLine{847       c0    = j -\/ 3;}
\DoxyCodeLine{848       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{849       maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxl);}
\DoxyCodeLine{850       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{851         \textcolor{keywordflow}{if} (S\_cons[l] != 3)}
\DoxyCodeLine{852           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{853 }
\DoxyCodeLine{854         eee = 0;}
\DoxyCodeLine{855 }
\DoxyCodeLine{856         \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{857           u1  = a2s[ss][j -\/ 1] -\/ a2s[ss][l];}
\DoxyCodeLine{858           eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{859         \}}
\DoxyCodeLine{860 }
\DoxyCodeLine{861         \textcolor{keywordflow}{if} (c == mm + ggg[k][l -\/ k] + eee) \{}
\DoxyCodeLine{862           *p  = k;}
\DoxyCodeLine{863           *q  = l;}
\DoxyCodeLine{864           \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{865         \}}
\DoxyCodeLine{866       \}}
\DoxyCodeLine{867     \}}
\DoxyCodeLine{868   \}}
\DoxyCodeLine{869 }
\DoxyCodeLine{870   l = j -\/ 1;}
\DoxyCodeLine{871   \textcolor{keywordflow}{if} (S\_cons[l] == 3) \{}
\DoxyCodeLine{872     \textcolor{keywordflow}{for} (k = i + 4; k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE; k++) \{}
\DoxyCodeLine{873       l1 = k -\/ i -\/ 1;}
\DoxyCodeLine{874       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{875         \textcolor{keywordflow}{break};}
\DoxyCodeLine{876 }
\DoxyCodeLine{877       \textcolor{keywordflow}{if} (S\_cons[k] != 3)}
\DoxyCodeLine{878         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{879 }
\DoxyCodeLine{880       eee = 0;}
\DoxyCodeLine{881 }
\DoxyCodeLine{882       \textcolor{keywordflow}{for} (ss = 0; ss < n\_seq; ss++) \{}
\DoxyCodeLine{883         u1  = a2s[ss][k -\/ 1] -\/ a2s[ss][i];}
\DoxyCodeLine{884         eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{885       \}}
\DoxyCodeLine{886 }
\DoxyCodeLine{887       \textcolor{keywordflow}{if} (c == mm + ggg[k][l -\/ k] + eee) \{}
\DoxyCodeLine{888         *p  = k;}
\DoxyCodeLine{889         *q  = l;}
\DoxyCodeLine{890         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{891       \}}
\DoxyCodeLine{892     \}}
\DoxyCodeLine{893   \}}
\DoxyCodeLine{894 }
\DoxyCodeLine{895   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{896 \}}
\DoxyCodeLine{897 }
\DoxyCodeLine{898 }
\DoxyCodeLine{899 PRIVATE INLINE}
\DoxyCodeLine{900 \textcolor{keywordtype}{int}}
\DoxyCodeLine{901 E\_GQuad\_IntLoop(\textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{902                 \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{903                 \textcolor{keywordtype}{int}           type,}
\DoxyCodeLine{904                 \textcolor{keywordtype}{short}         *S,}
\DoxyCodeLine{905                 \textcolor{keywordtype}{int}           *ggg,}
\DoxyCodeLine{906                 \textcolor{keywordtype}{int}           *index,}
\DoxyCodeLine{907                 \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{908 \{}
\DoxyCodeLine{909   \textcolor{keywordtype}{int}   energy, ge, \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}, p, q, l1, minq, maxq, c0;}
\DoxyCodeLine{910   \textcolor{keywordtype}{short} si, sj;}
\DoxyCodeLine{911 }
\DoxyCodeLine{912   \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} = P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{913   si      = S[i + 1];}
\DoxyCodeLine{914   sj      = S[j -\/ 1];}
\DoxyCodeLine{915   energy  = 0;}
\DoxyCodeLine{916 }
\DoxyCodeLine{917   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} == 2)}
\DoxyCodeLine{918     energy += P-\/>mismatchI[type][si][sj];}
\DoxyCodeLine{919 }
\DoxyCodeLine{920   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{921     energy += P-\/>TerminalAU;}
\DoxyCodeLine{922 }
\DoxyCodeLine{923   ge = \mbox{\hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF}};}
\DoxyCodeLine{924 }
\DoxyCodeLine{925   p = i + 1;}
\DoxyCodeLine{926   \textcolor{keywordflow}{if} (S[p] == 3) \{}
\DoxyCodeLine{927     \textcolor{keywordflow}{if} (p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{928       minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{929       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{930       minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{931       c0    = j -\/ 3;}
\DoxyCodeLine{932       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{933       maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{934       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{935         \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{936           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{937 }
\DoxyCodeLine{938         c0  = energy + ggg[index[q] + p] + P-\/>internal\_loop[j -\/ q -\/ 1];}
\DoxyCodeLine{939         ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{940       \}}
\DoxyCodeLine{941     \}}
\DoxyCodeLine{942   \}}
\DoxyCodeLine{943 }
\DoxyCodeLine{944   \textcolor{keywordflow}{for} (p = i + 2;}
\DoxyCodeLine{945        p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{946        p++) \{}
\DoxyCodeLine{947     l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{948     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{949       \textcolor{keywordflow}{break};}
\DoxyCodeLine{950 }
\DoxyCodeLine{951     \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{952       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{953 }
\DoxyCodeLine{954     minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{955     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{956     minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{957     c0    = j -\/ 1;}
\DoxyCodeLine{958     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{959     maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{960     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{961       \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{962         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{963 }
\DoxyCodeLine{964       c0  = energy + ggg[index[q] + p] + P-\/>internal\_loop[l1 + j -\/ q -\/ 1];}
\DoxyCodeLine{965       ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{966     \}}
\DoxyCodeLine{967   \}}
\DoxyCodeLine{968 }
\DoxyCodeLine{969   q = j -\/ 1;}
\DoxyCodeLine{970   \textcolor{keywordflow}{if} (S[q] == 3)}
\DoxyCodeLine{971     \textcolor{keywordflow}{for} (p = i + 4;}
\DoxyCodeLine{972          p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{973          p++) \{}
\DoxyCodeLine{974       l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{975       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{976         \textcolor{keywordflow}{break};}
\DoxyCodeLine{977 }
\DoxyCodeLine{978       \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{979         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{980 }
\DoxyCodeLine{981       c0  = energy + ggg[index[q] + p] + P-\/>internal\_loop[l1];}
\DoxyCodeLine{982       ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{983     \}}
\DoxyCodeLine{984 }
\DoxyCodeLine{985 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{986   \textcolor{comment}{/* here comes the additional stuff for the odd dangle models */}}
\DoxyCodeLine{987   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} \% 1) \{}
\DoxyCodeLine{988     en1 = energy + P-\/>dangle5[type][si];}
\DoxyCodeLine{989     en2 = energy + P-\/>dangle5[type][sj];}
\DoxyCodeLine{990     en3 = energy + P-\/>mismatchI[type][si][sj];}
\DoxyCodeLine{991 }
\DoxyCodeLine{992     \textcolor{comment}{/* first case with 5' dangle (i.e. j-\/1) onto enclosing pair */}}
\DoxyCodeLine{993     p = i + 1;}
\DoxyCodeLine{994     \textcolor{keywordflow}{if} (S[p] == 3) \{}
\DoxyCodeLine{995       \textcolor{keywordflow}{if} (p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{996         minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{997         c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{998         minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{999         c0    = j -\/ 4;}
\DoxyCodeLine{1000         maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1001         maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1002         \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1003           \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{1004             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1005 }
\DoxyCodeLine{1006           c0  = en1 + ggg[index[q] + p] + P-\/>internal\_loop[j -\/ q -\/ 1];}
\DoxyCodeLine{1007           ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1008         \}}
\DoxyCodeLine{1009       \}}
\DoxyCodeLine{1010     \}}
\DoxyCodeLine{1011 }
\DoxyCodeLine{1012     \textcolor{keywordflow}{for} (p = i + 2; p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE; p++) \{}
\DoxyCodeLine{1013       l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1014       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1015         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1016 }
\DoxyCodeLine{1017       \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{1018         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1019 }
\DoxyCodeLine{1020       minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1021       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1022       minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1023       c0    = j -\/ 2;}
\DoxyCodeLine{1024       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1025       maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1026       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1027         \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{1028           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1029 }
\DoxyCodeLine{1030         c0  = en1 + ggg[index[q] + p] + P-\/>internal\_loop[l1 + j -\/ q -\/ 1];}
\DoxyCodeLine{1031         ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1032       \}}
\DoxyCodeLine{1033     \}}
\DoxyCodeLine{1034 }
\DoxyCodeLine{1035     q = j -\/ 2;}
\DoxyCodeLine{1036     \textcolor{keywordflow}{if} (S[q] == 3)}
\DoxyCodeLine{1037       \textcolor{keywordflow}{for} (p = i + 4; p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE; p++) \{}
\DoxyCodeLine{1038         l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1039         \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1040           \textcolor{keywordflow}{break};}
\DoxyCodeLine{1041 }
\DoxyCodeLine{1042         \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{1043           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1044 }
\DoxyCodeLine{1045         c0  = en1 + ggg[index[q] + p] + P-\/>internal\_loop[l1 + 1];}
\DoxyCodeLine{1046         ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1047       \}}
\DoxyCodeLine{1048 }
\DoxyCodeLine{1049     \textcolor{comment}{/* second case with 3' dangle (i.e. i+1) onto enclosing pair */}}
\DoxyCodeLine{1050   \}}
\DoxyCodeLine{1051 }
\DoxyCodeLine{1052 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1053   \textcolor{keywordflow}{return} ge;}
\DoxyCodeLine{1054 \}}
\DoxyCodeLine{1055 }
\DoxyCodeLine{1056 }
\DoxyCodeLine{1057 PRIVATE INLINE}
\DoxyCodeLine{1058 \textcolor{keywordtype}{int}}
\DoxyCodeLine{1059 E\_GQuad\_IntLoop\_comparative(\textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{1060                             \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{1061                             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  *tt,}
\DoxyCodeLine{1062                             \textcolor{keywordtype}{short}         *S\_cons,}
\DoxyCodeLine{1063                             \textcolor{keywordtype}{short}         **S5,}
\DoxyCodeLine{1064                             \textcolor{keywordtype}{short}         **S3,}
\DoxyCodeLine{1065                             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  **a2s,}
\DoxyCodeLine{1066                             \textcolor{keywordtype}{int}           *ggg,}
\DoxyCodeLine{1067                             \textcolor{keywordtype}{int}           *index,}
\DoxyCodeLine{1068                             \textcolor{keywordtype}{int}           n\_seq,}
\DoxyCodeLine{1069                             \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{1070 \{}
\DoxyCodeLine{1071   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  type;}
\DoxyCodeLine{1072   \textcolor{keywordtype}{int}           eee, energy, ge, p, q, l1, u1, u2, minq, maxq, c0, s;}
\DoxyCodeLine{1073   \mbox{\hyperlink{group__model__details_structvrna__md__s}{vrna\_md\_t}}     *md;}
\DoxyCodeLine{1074 }
\DoxyCodeLine{1075   md      = \&(P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}});}
\DoxyCodeLine{1076   energy  = 0;}
\DoxyCodeLine{1077 }
\DoxyCodeLine{1078   \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1079     type = tt[s];}
\DoxyCodeLine{1080     \textcolor{keywordflow}{if} (md-\/>\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}} == 2)}
\DoxyCodeLine{1081       energy += P-\/>mismatchI[type][S3[s][i]][S5[s][j]];}
\DoxyCodeLine{1082 }
\DoxyCodeLine{1083     \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{1084       energy += P-\/>TerminalAU;}
\DoxyCodeLine{1085   \}}
\DoxyCodeLine{1086 }
\DoxyCodeLine{1087   ge = \mbox{\hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF}};}
\DoxyCodeLine{1088 }
\DoxyCodeLine{1089   p = i + 1;}
\DoxyCodeLine{1090   \textcolor{keywordflow}{if} (S\_cons[p] == 3) \{}
\DoxyCodeLine{1091     \textcolor{keywordflow}{if} (p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{1092       minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1093       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1094       minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1095       c0    = j -\/ 3;}
\DoxyCodeLine{1096       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1097       maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1098       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1099         \textcolor{keywordflow}{if} (S\_cons[q] != 3)}
\DoxyCodeLine{1100           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1101 }
\DoxyCodeLine{1102         eee = 0;}
\DoxyCodeLine{1103 }
\DoxyCodeLine{1104         \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1105           u1  = a2s[s][j -\/ 1] -\/ a2s[s][q];}
\DoxyCodeLine{1106           eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{1107         \}}
\DoxyCodeLine{1108 }
\DoxyCodeLine{1109         c0 = energy +}
\DoxyCodeLine{1110              ggg[index[q] + p] +}
\DoxyCodeLine{1111              eee;}
\DoxyCodeLine{1112         ge = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1113       \}}
\DoxyCodeLine{1114     \}}
\DoxyCodeLine{1115   \}}
\DoxyCodeLine{1116 }
\DoxyCodeLine{1117   \textcolor{keywordflow}{for} (p = i + 2;}
\DoxyCodeLine{1118        p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1119        p++) \{}
\DoxyCodeLine{1120     l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1121     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1122       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1123 }
\DoxyCodeLine{1124     \textcolor{keywordflow}{if} (S\_cons[p] != 3)}
\DoxyCodeLine{1125       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1126 }
\DoxyCodeLine{1127     minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1128     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1129     minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1130     c0    = j -\/ 1;}
\DoxyCodeLine{1131     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1132     maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1133     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1134       \textcolor{keywordflow}{if} (S\_cons[q] != 3)}
\DoxyCodeLine{1135         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1136 }
\DoxyCodeLine{1137       eee = 0;}
\DoxyCodeLine{1138 }
\DoxyCodeLine{1139       \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1140         u1  = a2s[s][p -\/ 1] -\/ a2s[s][i];}
\DoxyCodeLine{1141         u2  = a2s[s][j -\/ 1] -\/ a2s[s][q];}
\DoxyCodeLine{1142         eee += P-\/>internal\_loop[u1 + u2];}
\DoxyCodeLine{1143       \}}
\DoxyCodeLine{1144 }
\DoxyCodeLine{1145       c0 = energy +}
\DoxyCodeLine{1146            ggg[index[q] + p] +}
\DoxyCodeLine{1147            eee;}
\DoxyCodeLine{1148       ge = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1149     \}}
\DoxyCodeLine{1150   \}}
\DoxyCodeLine{1151 }
\DoxyCodeLine{1152   q = j -\/ 1;}
\DoxyCodeLine{1153   \textcolor{keywordflow}{if} (S\_cons[q] == 3)}
\DoxyCodeLine{1154     \textcolor{keywordflow}{for} (p = i + 4;}
\DoxyCodeLine{1155          p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1156          p++) \{}
\DoxyCodeLine{1157       l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1158       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1159         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1160 }
\DoxyCodeLine{1161       \textcolor{keywordflow}{if} (S\_cons[p] != 3)}
\DoxyCodeLine{1162         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1163 }
\DoxyCodeLine{1164       eee = 0;}
\DoxyCodeLine{1165 }
\DoxyCodeLine{1166       \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1167         u1  = a2s[s][p -\/ 1] -\/ a2s[s][i];}
\DoxyCodeLine{1168         eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{1169       \}}
\DoxyCodeLine{1170 }
\DoxyCodeLine{1171       c0 = energy +}
\DoxyCodeLine{1172            ggg[index[q] + p] +}
\DoxyCodeLine{1173            eee;}
\DoxyCodeLine{1174       ge = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1175     \}}
\DoxyCodeLine{1176 }
\DoxyCodeLine{1177   \textcolor{keywordflow}{return} ge;}
\DoxyCodeLine{1178 \}}
\DoxyCodeLine{1179 }
\DoxyCodeLine{1180 }
\DoxyCodeLine{1181 PRIVATE INLINE}
\DoxyCodeLine{1182 \textcolor{keywordtype}{int}}
\DoxyCodeLine{1183 E\_GQuad\_IntLoop\_L\_comparative(\textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{1184                               \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{1185                               \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  *tt,}
\DoxyCodeLine{1186                               \textcolor{keywordtype}{short}         *S\_cons,}
\DoxyCodeLine{1187                               \textcolor{keywordtype}{short}         **S5,}
\DoxyCodeLine{1188                               \textcolor{keywordtype}{short}         **S3,}
\DoxyCodeLine{1189                               \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  **a2s,}
\DoxyCodeLine{1190                               \textcolor{keywordtype}{int}           **ggg,}
\DoxyCodeLine{1191                               \textcolor{keywordtype}{int}           n\_seq,}
\DoxyCodeLine{1192                               \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{1193 \{}
\DoxyCodeLine{1194   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  type;}
\DoxyCodeLine{1195   \textcolor{keywordtype}{int}           eee, energy, ge, p, q, l1, u1, u2, minq, maxq, c0, s;}
\DoxyCodeLine{1196   \mbox{\hyperlink{group__model__details_structvrna__md__s}{vrna\_md\_t}}     *md;}
\DoxyCodeLine{1197 }
\DoxyCodeLine{1198   md      = \&(P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}});}
\DoxyCodeLine{1199   energy  = 0;}
\DoxyCodeLine{1200 }
\DoxyCodeLine{1201   \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1202     type = tt[s];}
\DoxyCodeLine{1203     \textcolor{keywordflow}{if} (md-\/>\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}} == 2)}
\DoxyCodeLine{1204       energy += P-\/>mismatchI[type][S3[s][i]][S5[s][j]];}
\DoxyCodeLine{1205 }
\DoxyCodeLine{1206     \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{1207       energy += P-\/>TerminalAU;}
\DoxyCodeLine{1208   \}}
\DoxyCodeLine{1209 }
\DoxyCodeLine{1210   ge = \mbox{\hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF}};}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212   p = i + 1;}
\DoxyCodeLine{1213   \textcolor{keywordflow}{if} (S\_cons[p] == 3) \{}
\DoxyCodeLine{1214     \textcolor{keywordflow}{if} (p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{1215       minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1216       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1217       minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1218       c0    = j -\/ 3;}
\DoxyCodeLine{1219       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1220       maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1221       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1222         \textcolor{keywordflow}{if} (S\_cons[q] != 3)}
\DoxyCodeLine{1223           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1224 }
\DoxyCodeLine{1225         eee = 0;}
\DoxyCodeLine{1226 }
\DoxyCodeLine{1227         \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1228           u1  = a2s[s][j -\/ 1] -\/ a2s[s][q];}
\DoxyCodeLine{1229           eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{1230         \}}
\DoxyCodeLine{1231 }
\DoxyCodeLine{1232         c0 = energy +}
\DoxyCodeLine{1233              ggg[p][q -\/ p] +}
\DoxyCodeLine{1234              eee;}
\DoxyCodeLine{1235         ge = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1236       \}}
\DoxyCodeLine{1237     \}}
\DoxyCodeLine{1238   \}}
\DoxyCodeLine{1239 }
\DoxyCodeLine{1240   \textcolor{keywordflow}{for} (p = i + 2;}
\DoxyCodeLine{1241        p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1242        p++) \{}
\DoxyCodeLine{1243     l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1244     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1245       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1246 }
\DoxyCodeLine{1247     \textcolor{keywordflow}{if} (S\_cons[p] != 3)}
\DoxyCodeLine{1248       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1249 }
\DoxyCodeLine{1250     minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1251     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1252     minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1253     c0    = j -\/ 1;}
\DoxyCodeLine{1254     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1255     maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1256     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1257       \textcolor{keywordflow}{if} (S\_cons[q] != 3)}
\DoxyCodeLine{1258         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1259 }
\DoxyCodeLine{1260       eee = 0;}
\DoxyCodeLine{1261 }
\DoxyCodeLine{1262       \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1263         u1  = a2s[s][p -\/ 1] -\/ a2s[s][i];}
\DoxyCodeLine{1264         u2  = a2s[s][j -\/ 1] -\/ a2s[s][q];}
\DoxyCodeLine{1265         eee += P-\/>internal\_loop[u1 + u2];}
\DoxyCodeLine{1266       \}}
\DoxyCodeLine{1267 }
\DoxyCodeLine{1268       c0 = energy +}
\DoxyCodeLine{1269            ggg[p][q -\/ p] +}
\DoxyCodeLine{1270            eee;}
\DoxyCodeLine{1271       ge = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1272     \}}
\DoxyCodeLine{1273   \}}
\DoxyCodeLine{1274 }
\DoxyCodeLine{1275   q = j -\/ 1;}
\DoxyCodeLine{1276   \textcolor{keywordflow}{if} (S\_cons[q] == 3)}
\DoxyCodeLine{1277     \textcolor{keywordflow}{for} (p = i + 4;}
\DoxyCodeLine{1278          p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1279          p++) \{}
\DoxyCodeLine{1280       l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1281       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1282         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1283 }
\DoxyCodeLine{1284       \textcolor{keywordflow}{if} (S\_cons[p] != 3)}
\DoxyCodeLine{1285         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1286 }
\DoxyCodeLine{1287       eee = 0;}
\DoxyCodeLine{1288 }
\DoxyCodeLine{1289       \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1290         u1  = a2s[s][p -\/ 1] -\/ a2s[s][i];}
\DoxyCodeLine{1291         eee += P-\/>internal\_loop[u1];}
\DoxyCodeLine{1292       \}}
\DoxyCodeLine{1293 }
\DoxyCodeLine{1294       c0 = energy +}
\DoxyCodeLine{1295            ggg[p][q -\/ p] +}
\DoxyCodeLine{1296            eee;}
\DoxyCodeLine{1297       ge = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1298     \}}
\DoxyCodeLine{1299 }
\DoxyCodeLine{1300   \textcolor{keywordflow}{return} ge;}
\DoxyCodeLine{1301 \}}
\DoxyCodeLine{1302 }
\DoxyCodeLine{1303 }
\DoxyCodeLine{1304 PRIVATE INLINE}
\DoxyCodeLine{1305 \textcolor{keywordtype}{int} *}
\DoxyCodeLine{1306 E\_GQuad\_IntLoop\_exhaustive(\textcolor{keywordtype}{int}          i,}
\DoxyCodeLine{1307                            \textcolor{keywordtype}{int}          j,}
\DoxyCodeLine{1308                            \textcolor{keywordtype}{int}          **p\_p,}
\DoxyCodeLine{1309                            \textcolor{keywordtype}{int}          **q\_p,}
\DoxyCodeLine{1310                            \textcolor{keywordtype}{int}          type,}
\DoxyCodeLine{1311                            \textcolor{keywordtype}{short}        *S,}
\DoxyCodeLine{1312                            \textcolor{keywordtype}{int}          *ggg,}
\DoxyCodeLine{1313                            \textcolor{keywordtype}{int}          threshold,}
\DoxyCodeLine{1314                            \textcolor{keywordtype}{int}          *index,}
\DoxyCodeLine{1315                            \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P)}
\DoxyCodeLine{1316 \{}
\DoxyCodeLine{1317   \textcolor{keywordtype}{int}   energy, *ge, \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}, p, q, l1, minq, maxq, c0;}
\DoxyCodeLine{1318   \textcolor{keywordtype}{short} si, sj;}
\DoxyCodeLine{1319   \textcolor{keywordtype}{int}   cnt = 0;}
\DoxyCodeLine{1320 }
\DoxyCodeLine{1321   \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} = P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{1322   si      = S[i + 1];}
\DoxyCodeLine{1323   sj      = S[j -\/ 1];}
\DoxyCodeLine{1324   energy  = 0;}
\DoxyCodeLine{1325 }
\DoxyCodeLine{1326   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} == 2)}
\DoxyCodeLine{1327     energy += P-\/>mismatchI[type][si][sj];}
\DoxyCodeLine{1328 }
\DoxyCodeLine{1329   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{1330     energy += P-\/>TerminalAU;}
\DoxyCodeLine{1331 }
\DoxyCodeLine{1332   \textcolor{comment}{/* guess how many gquads are possible in interval [i+1,j-\/1] */}}
\DoxyCodeLine{1333   *p\_p  = (\textcolor{keywordtype}{int} *)\mbox{\hyperlink{group__utils_gafae44c31c8772450d6c674a582be3e3c}{vrna\_alloc}}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 256);}
\DoxyCodeLine{1334   *q\_p  = (\textcolor{keywordtype}{int} *)\mbox{\hyperlink{group__utils_gafae44c31c8772450d6c674a582be3e3c}{vrna\_alloc}}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 256);}
\DoxyCodeLine{1335   ge    = (\textcolor{keywordtype}{int} *)\mbox{\hyperlink{group__utils_gafae44c31c8772450d6c674a582be3e3c}{vrna\_alloc}}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 256);}
\DoxyCodeLine{1336 }
\DoxyCodeLine{1337   p = i + 1;}
\DoxyCodeLine{1338   \textcolor{keywordflow}{if} (S[p] == 3) \{}
\DoxyCodeLine{1339     \textcolor{keywordflow}{if} (p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{1340       minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1341       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1342       minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1343       c0    = j -\/ 3;}
\DoxyCodeLine{1344       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1345       maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1346       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1347         \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{1348           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1349 }
\DoxyCodeLine{1350         c0 = energy + ggg[index[q] + p] + P-\/>internal\_loop[j -\/ q -\/ 1];}
\DoxyCodeLine{1351         \textcolor{keywordflow}{if} (c0 <= threshold) \{}
\DoxyCodeLine{1352           ge[cnt]       = energy + P-\/>internal\_loop[j -\/ q -\/ 1];}
\DoxyCodeLine{1353           (*p\_p)[cnt]   = p;}
\DoxyCodeLine{1354           (*q\_p)[cnt++] = q;}
\DoxyCodeLine{1355         \}}
\DoxyCodeLine{1356       \}}
\DoxyCodeLine{1357     \}}
\DoxyCodeLine{1358   \}}
\DoxyCodeLine{1359 }
\DoxyCodeLine{1360   \textcolor{keywordflow}{for} (p = i + 2;}
\DoxyCodeLine{1361        p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1362        p++) \{}
\DoxyCodeLine{1363     l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1364     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1365       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1366 }
\DoxyCodeLine{1367     \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{1368       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1369 }
\DoxyCodeLine{1370     minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1371     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1372     minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1373     c0    = j -\/ 1;}
\DoxyCodeLine{1374     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1375     maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1376     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1377       \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{1378         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1379 }
\DoxyCodeLine{1380       c0 = energy + ggg[index[q] + p] + P-\/>internal\_loop[l1 + j -\/ q -\/ 1];}
\DoxyCodeLine{1381       \textcolor{keywordflow}{if} (c0 <= threshold) \{}
\DoxyCodeLine{1382         ge[cnt]       = energy + P-\/>internal\_loop[l1 + j -\/ q -\/ 1];}
\DoxyCodeLine{1383         (*p\_p)[cnt]   = p;}
\DoxyCodeLine{1384         (*q\_p)[cnt++] = q;}
\DoxyCodeLine{1385       \}}
\DoxyCodeLine{1386     \}}
\DoxyCodeLine{1387   \}}
\DoxyCodeLine{1388 }
\DoxyCodeLine{1389   q = j -\/ 1;}
\DoxyCodeLine{1390   \textcolor{keywordflow}{if} (S[q] == 3)}
\DoxyCodeLine{1391     \textcolor{keywordflow}{for} (p = i + 4;}
\DoxyCodeLine{1392          p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1393          p++) \{}
\DoxyCodeLine{1394       l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1395       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1396         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1397 }
\DoxyCodeLine{1398       \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{1399         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1400 }
\DoxyCodeLine{1401       c0 = energy + ggg[index[q] + p] + P-\/>internal\_loop[l1];}
\DoxyCodeLine{1402       \textcolor{keywordflow}{if} (c0 <= threshold) \{}
\DoxyCodeLine{1403         ge[cnt]       = energy + P-\/>internal\_loop[l1];}
\DoxyCodeLine{1404         (*p\_p)[cnt]   = p;}
\DoxyCodeLine{1405         (*q\_p)[cnt++] = q;}
\DoxyCodeLine{1406       \}}
\DoxyCodeLine{1407     \}}
\DoxyCodeLine{1408 }
\DoxyCodeLine{1409   (*p\_p)[cnt] = -\/1;}
\DoxyCodeLine{1410 }
\DoxyCodeLine{1411   \textcolor{keywordflow}{return} ge;}
\DoxyCodeLine{1412 \}}
\DoxyCodeLine{1413 }
\DoxyCodeLine{1414 }
\DoxyCodeLine{1415 PRIVATE INLINE}
\DoxyCodeLine{1416 \textcolor{keywordtype}{int}}
\DoxyCodeLine{1417 E\_GQuad\_IntLoop\_L(\textcolor{keywordtype}{int}           i,}
\DoxyCodeLine{1418                   \textcolor{keywordtype}{int}           j,}
\DoxyCodeLine{1419                   \textcolor{keywordtype}{int}           type,}
\DoxyCodeLine{1420                   \textcolor{keywordtype}{short}         *S,}
\DoxyCodeLine{1421                   \textcolor{keywordtype}{int}           **ggg,}
\DoxyCodeLine{1422                   \textcolor{keywordtype}{int}           maxdist,}
\DoxyCodeLine{1423                   \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}  *P)}
\DoxyCodeLine{1424 \{}
\DoxyCodeLine{1425   \textcolor{keywordtype}{int}   energy, ge, \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}, p, q, l1, minq, maxq, c0;}
\DoxyCodeLine{1426   \textcolor{keywordtype}{short} si, sj;}
\DoxyCodeLine{1427 }
\DoxyCodeLine{1428   \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} = P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}};}
\DoxyCodeLine{1429   si      = S[i + 1];}
\DoxyCodeLine{1430   sj      = S[j -\/ 1];}
\DoxyCodeLine{1431   energy  = 0;}
\DoxyCodeLine{1432 }
\DoxyCodeLine{1433   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}} == 2)}
\DoxyCodeLine{1434     energy += P-\/>mismatchI[type][si][sj];}
\DoxyCodeLine{1435 }
\DoxyCodeLine{1436   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{1437     energy += P-\/>TerminalAU;}
\DoxyCodeLine{1438 }
\DoxyCodeLine{1439   ge = \mbox{\hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF}};}
\DoxyCodeLine{1440 }
\DoxyCodeLine{1441   p = i + 1;}
\DoxyCodeLine{1442   \textcolor{keywordflow}{if} (S[p] == 3) \{}
\DoxyCodeLine{1443     \textcolor{keywordflow}{if} (p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{1444       minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1445       c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1446       minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1447       c0    = j -\/ 3;}
\DoxyCodeLine{1448       maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1449       maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1450       \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1451         \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{1452           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1453 }
\DoxyCodeLine{1454         c0  = energy + ggg[p][q -\/ p] + P-\/>internal\_loop[j -\/ q -\/ 1];}
\DoxyCodeLine{1455         ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1456       \}}
\DoxyCodeLine{1457     \}}
\DoxyCodeLine{1458   \}}
\DoxyCodeLine{1459 }
\DoxyCodeLine{1460   \textcolor{keywordflow}{for} (p = i + 2;}
\DoxyCodeLine{1461        p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1462        p++) \{}
\DoxyCodeLine{1463     l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1464     \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1465       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1466 }
\DoxyCodeLine{1467     \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{1468       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1469 }
\DoxyCodeLine{1470     minq  = j -\/ i + p -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1471     c0    = p + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1472     minq  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(c0, minq);}
\DoxyCodeLine{1473     c0    = j -\/ 1;}
\DoxyCodeLine{1474     maxq  = p + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1475     maxq  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(c0, maxq);}
\DoxyCodeLine{1476     \textcolor{keywordflow}{for} (q = minq; q < maxq; q++) \{}
\DoxyCodeLine{1477       \textcolor{keywordflow}{if} (S[q] != 3)}
\DoxyCodeLine{1478         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1479 }
\DoxyCodeLine{1480       c0  = energy + ggg[p][q -\/ p] + P-\/>internal\_loop[l1 + j -\/ q -\/ 1];}
\DoxyCodeLine{1481       ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1482     \}}
\DoxyCodeLine{1483   \}}
\DoxyCodeLine{1484 }
\DoxyCodeLine{1485   q = j -\/ 1;}
\DoxyCodeLine{1486   \textcolor{keywordflow}{if} (S[q] == 3)}
\DoxyCodeLine{1487     \textcolor{keywordflow}{for} (p = i + 4;}
\DoxyCodeLine{1488          p < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1489          p++) \{}
\DoxyCodeLine{1490       l1 = p -\/ i -\/ 1;}
\DoxyCodeLine{1491       \textcolor{keywordflow}{if} (l1 > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1492         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1493 }
\DoxyCodeLine{1494       \textcolor{keywordflow}{if} (S[p] != 3)}
\DoxyCodeLine{1495         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1496 }
\DoxyCodeLine{1497       c0  = energy + ggg[p][q -\/ p] + P-\/>internal\_loop[l1];}
\DoxyCodeLine{1498       ge  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(ge, c0);}
\DoxyCodeLine{1499     \}}
\DoxyCodeLine{1500 }
\DoxyCodeLine{1501   \textcolor{keywordflow}{return} ge;}
\DoxyCodeLine{1502 \}}
\DoxyCodeLine{1503 }
\DoxyCodeLine{1504 }
\DoxyCodeLine{1505 PRIVATE INLINE}
\DoxyCodeLine{1506 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{1507 exp\_E\_GQuad\_IntLoop(\textcolor{keywordtype}{int}               i,}
\DoxyCodeLine{1508                     \textcolor{keywordtype}{int}               j,}
\DoxyCodeLine{1509                     \textcolor{keywordtype}{int}               type,}
\DoxyCodeLine{1510                     \textcolor{keywordtype}{short}             *S,}
\DoxyCodeLine{1511                     \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}        *G,}
\DoxyCodeLine{1512                     \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}        *scale,}
\DoxyCodeLine{1513                     \textcolor{keywordtype}{int}               *index,}
\DoxyCodeLine{1514                     \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}  *pf)}
\DoxyCodeLine{1515 \{}
\DoxyCodeLine{1516   \textcolor{keywordtype}{int}         k, l, minl, maxl, u, r;}
\DoxyCodeLine{1517   \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}  q, qe;}
\DoxyCodeLine{1518   \textcolor{keywordtype}{double}      *expintern;}
\DoxyCodeLine{1519   \textcolor{keywordtype}{short}       si, sj;}
\DoxyCodeLine{1520 }
\DoxyCodeLine{1521   q         = 0;}
\DoxyCodeLine{1522   si        = S[i + 1];}
\DoxyCodeLine{1523   sj        = S[j -\/ 1];}
\DoxyCodeLine{1524   qe        = (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})pf-\/>expmismatchI[type][si][sj];}
\DoxyCodeLine{1525   expintern = \&(pf-\/>expinternal[0]);}
\DoxyCodeLine{1526 }
\DoxyCodeLine{1527   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{1528     qe *= (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})pf-\/>expTermAU;}
\DoxyCodeLine{1529 }
\DoxyCodeLine{1530   k = i + 1;}
\DoxyCodeLine{1531   if (S[k] == 3) \{}
\DoxyCodeLine{1532     \textcolor{keywordflow}{if} (k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{1533       minl  = j -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 1;}
\DoxyCodeLine{1534       u     = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1535       minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(u, minl);}
\DoxyCodeLine{1536       u     = j -\/ 3;}
\DoxyCodeLine{1537       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1538       maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(u, maxl);}
\DoxyCodeLine{1539       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{1540         \textcolor{keywordflow}{if} (S[l] != 3)}
\DoxyCodeLine{1541           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1542 }
\DoxyCodeLine{1543         \textcolor{keywordflow}{if} (G[index[k] -\/ l] == 0.)}
\DoxyCodeLine{1544           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1545 }
\DoxyCodeLine{1546         q += qe}
\DoxyCodeLine{1547              * G[index[k] -\/ l]}
\DoxyCodeLine{1548              * (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})expintern[j -\/ l -\/ 1]}
\DoxyCodeLine{1549              * scale[j -\/ l + 1];}
\DoxyCodeLine{1550       \}}
\DoxyCodeLine{1551     \}}
\DoxyCodeLine{1552   \}}
\DoxyCodeLine{1553 }
\DoxyCodeLine{1554   \textcolor{keywordflow}{for} (k = i + 2;}
\DoxyCodeLine{1555        k <= j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1556        k++) \{}
\DoxyCodeLine{1557     u = k -\/ i -\/ 1;}
\DoxyCodeLine{1558     \textcolor{keywordflow}{if} (u > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1559       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1560 }
\DoxyCodeLine{1561     \textcolor{keywordflow}{if} (S[k] != 3)}
\DoxyCodeLine{1562       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1563 }
\DoxyCodeLine{1564     minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1565     r     = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1566     minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(r, minl);}
\DoxyCodeLine{1567     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1568     r     = j -\/ 1;}
\DoxyCodeLine{1569     maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(r, maxl);}
\DoxyCodeLine{1570     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{1571       \textcolor{keywordflow}{if} (S[l] != 3)}
\DoxyCodeLine{1572         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1573 }
\DoxyCodeLine{1574       \textcolor{keywordflow}{if} (G[index[k] -\/ l] == 0.)}
\DoxyCodeLine{1575         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1576 }
\DoxyCodeLine{1577       q += qe}
\DoxyCodeLine{1578            * G[index[k] -\/ l]}
\DoxyCodeLine{1579            * (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})expintern[u + j -\/ l -\/ 1]}
\DoxyCodeLine{1580            * scale[u + j -\/ l + 1];}
\DoxyCodeLine{1581     \}}
\DoxyCodeLine{1582   \}}
\DoxyCodeLine{1583 }
\DoxyCodeLine{1584   l = j -\/ 1;}
\DoxyCodeLine{1585   \textcolor{keywordflow}{if} (S[l] == 3)}
\DoxyCodeLine{1586     \textcolor{keywordflow}{for} (k = i + 4; k <= j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE; k++) \{}
\DoxyCodeLine{1587       u = k -\/ i -\/ 1;}
\DoxyCodeLine{1588       \textcolor{keywordflow}{if} (u > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1589         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1590 }
\DoxyCodeLine{1591       \textcolor{keywordflow}{if} (S[k] != 3)}
\DoxyCodeLine{1592         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1593 }
\DoxyCodeLine{1594       \textcolor{keywordflow}{if} (G[index[k] -\/ l] == 0.)}
\DoxyCodeLine{1595         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1596 }
\DoxyCodeLine{1597       q += qe}
\DoxyCodeLine{1598            * G[index[k] -\/ l]}
\DoxyCodeLine{1599            * (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})expintern[u]}
\DoxyCodeLine{1600            * scale[u + 2];}
\DoxyCodeLine{1601     \}}
\DoxyCodeLine{1602 }
\DoxyCodeLine{1603   \textcolor{keywordflow}{return} q;}
\DoxyCodeLine{1604 \}}
\DoxyCodeLine{1605 }
\DoxyCodeLine{1606 }
\DoxyCodeLine{1607 PRIVATE INLINE}
\DoxyCodeLine{1608 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{1609 exp\_E\_GQuad\_IntLoop\_comparative(\textcolor{keywordtype}{int}               i,}
\DoxyCodeLine{1610                                 \textcolor{keywordtype}{int}               j,}
\DoxyCodeLine{1611                                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}      *tt,}
\DoxyCodeLine{1612                                 \textcolor{keywordtype}{short}             *S\_cons,}
\DoxyCodeLine{1613                                 \textcolor{keywordtype}{short}             **S5,}
\DoxyCodeLine{1614                                 \textcolor{keywordtype}{short}             **S3,}
\DoxyCodeLine{1615                                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}      **a2s,}
\DoxyCodeLine{1616                                 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}        *G,}
\DoxyCodeLine{1617                                 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}        *scale,}
\DoxyCodeLine{1618                                 \textcolor{keywordtype}{int}               *index,}
\DoxyCodeLine{1619                                 \textcolor{keywordtype}{int}               n\_seq,}
\DoxyCodeLine{1620                                 \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}  *pf)}
\DoxyCodeLine{1621 \{}
\DoxyCodeLine{1622   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  type;}
\DoxyCodeLine{1623   \textcolor{keywordtype}{int}           k, l, minl, maxl, u, u1, u2, r, s;}
\DoxyCodeLine{1624   \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}    q, qe, qqq;}
\DoxyCodeLine{1625   \textcolor{keywordtype}{double}        *expintern;}
\DoxyCodeLine{1626   \mbox{\hyperlink{group__model__details_structvrna__md__s}{vrna\_md\_t}}     *md;}
\DoxyCodeLine{1627 }
\DoxyCodeLine{1628   q         = 0;}
\DoxyCodeLine{1629   qe        = 1.;}
\DoxyCodeLine{1630   md        = \&(pf-\/>\mbox{\hyperlink{group__energy__parameters_ac18055127bccc27c1223f1d2f3b01b53}{model\_details}});}
\DoxyCodeLine{1631   expintern = \&(pf-\/>expinternal[0]);}
\DoxyCodeLine{1632 }
\DoxyCodeLine{1633   \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1634     type = tt[s];}
\DoxyCodeLine{1635     \textcolor{keywordflow}{if} (md-\/>\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}} == 2)}
\DoxyCodeLine{1636       qe *= (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})pf-\/>expmismatchI[type][S3[s][i]][S5[s][j]];}
\DoxyCodeLine{1637 }
\DoxyCodeLine{1638     if (type > 2)}
\DoxyCodeLine{1639       qe *= (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})pf-\/>expTermAU;}
\DoxyCodeLine{1640   \}}
\DoxyCodeLine{1641 }
\DoxyCodeLine{1642   k = i + 1;}
\DoxyCodeLine{1643   \textcolor{keywordflow}{if} (S\_cons[k] == 3) \{}
\DoxyCodeLine{1644     \textcolor{keywordflow}{if} (k < j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE) \{}
\DoxyCodeLine{1645       minl  = j -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 1;}
\DoxyCodeLine{1646       u     = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1647       minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(u, minl);}
\DoxyCodeLine{1648       u     = j -\/ 3;}
\DoxyCodeLine{1649       maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1650       maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(u, maxl);}
\DoxyCodeLine{1651       \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{1652         \textcolor{keywordflow}{if} (S\_cons[l] != 3)}
\DoxyCodeLine{1653           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1654 }
\DoxyCodeLine{1655         \textcolor{keywordflow}{if} (G[index[k] -\/ l] == 0.)}
\DoxyCodeLine{1656           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1657 }
\DoxyCodeLine{1658         qqq = 1.;}
\DoxyCodeLine{1659 }
\DoxyCodeLine{1660         \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1661           u1  = a2s[s][j -\/ 1] -\/ a2s[s][l];}
\DoxyCodeLine{1662           qqq *= expintern[u1];}
\DoxyCodeLine{1663         \}}
\DoxyCodeLine{1664 }
\DoxyCodeLine{1665         q += qe *}
\DoxyCodeLine{1666              G[index[k] -\/ l] *}
\DoxyCodeLine{1667              qqq *}
\DoxyCodeLine{1668              scale[j -\/ l + 1];}
\DoxyCodeLine{1669       \}}
\DoxyCodeLine{1670     \}}
\DoxyCodeLine{1671   \}}
\DoxyCodeLine{1672 }
\DoxyCodeLine{1673   \textcolor{keywordflow}{for} (k = i + 2;}
\DoxyCodeLine{1674        k <= j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE;}
\DoxyCodeLine{1675        k++) \{}
\DoxyCodeLine{1676     u = k -\/ i -\/ 1;}
\DoxyCodeLine{1677     \textcolor{keywordflow}{if} (u > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1678       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1679 }
\DoxyCodeLine{1680     \textcolor{keywordflow}{if} (S\_cons[k] != 3)}
\DoxyCodeLine{1681       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1682 }
\DoxyCodeLine{1683     minl  = j -\/ i + k -\/ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}} -\/ 2;}
\DoxyCodeLine{1684     r     = k + VRNA\_GQUAD\_MIN\_BOX\_SIZE -\/ 1;}
\DoxyCodeLine{1685     minl  = \mbox{\hyperlink{group__utils_ga33297b3679c713b0c4d897cd0fe3b122}{MAX2}}(r, minl);}
\DoxyCodeLine{1686     maxl  = k + VRNA\_GQUAD\_MAX\_BOX\_SIZE + 1;}
\DoxyCodeLine{1687     r     = j -\/ 1;}
\DoxyCodeLine{1688     maxl  = \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(r, maxl);}
\DoxyCodeLine{1689     \textcolor{keywordflow}{for} (l = minl; l < maxl; l++) \{}
\DoxyCodeLine{1690       \textcolor{keywordflow}{if} (S\_cons[l] != 3)}
\DoxyCodeLine{1691         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1692 }
\DoxyCodeLine{1693       \textcolor{keywordflow}{if} (G[index[k] -\/ l] == 0.)}
\DoxyCodeLine{1694         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1695 }
\DoxyCodeLine{1696       qqq = 1.;}
\DoxyCodeLine{1697 }
\DoxyCodeLine{1698       \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1699         u1  = a2s[s][k -\/ 1] -\/ a2s[s][i];}
\DoxyCodeLine{1700         u2  = a2s[s][j -\/ 1] -\/ a2s[s][l];}
\DoxyCodeLine{1701         qqq *= expintern[u1 + u2];}
\DoxyCodeLine{1702       \}}
\DoxyCodeLine{1703 }
\DoxyCodeLine{1704       q += qe *}
\DoxyCodeLine{1705            G[index[k] -\/ l] *}
\DoxyCodeLine{1706            qqq *}
\DoxyCodeLine{1707            scale[u + j -\/ l + 1];}
\DoxyCodeLine{1708     \}}
\DoxyCodeLine{1709   \}}
\DoxyCodeLine{1710 }
\DoxyCodeLine{1711   l = j -\/ 1;}
\DoxyCodeLine{1712   \textcolor{keywordflow}{if} (S\_cons[l] == 3)}
\DoxyCodeLine{1713     \textcolor{keywordflow}{for} (k = i + 4; k <= j -\/ VRNA\_GQUAD\_MIN\_BOX\_SIZE; k++) \{}
\DoxyCodeLine{1714       u = k -\/ i -\/ 1;}
\DoxyCodeLine{1715       \textcolor{keywordflow}{if} (u > \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})}
\DoxyCodeLine{1716         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1717 }
\DoxyCodeLine{1718       \textcolor{keywordflow}{if} (S\_cons[k] != 3)}
\DoxyCodeLine{1719         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1720 }
\DoxyCodeLine{1721       \textcolor{keywordflow}{if} (G[index[k] -\/ l] == 0.)}
\DoxyCodeLine{1722         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1723 }
\DoxyCodeLine{1724       qqq = 1.;}
\DoxyCodeLine{1725 }
\DoxyCodeLine{1726       \textcolor{keywordflow}{for} (s = 0; s < n\_seq; s++) \{}
\DoxyCodeLine{1727         u1  = a2s[s][k -\/ 1] -\/ a2s[s][i];}
\DoxyCodeLine{1728         qqq *= expintern[u1];}
\DoxyCodeLine{1729       \}}
\DoxyCodeLine{1730 }
\DoxyCodeLine{1731       q += qe *}
\DoxyCodeLine{1732            G[index[k] -\/ l] *}
\DoxyCodeLine{1733            qqq *}
\DoxyCodeLine{1734            scale[u + 2];}
\DoxyCodeLine{1735     \}}
\DoxyCodeLine{1736 }
\DoxyCodeLine{1737   \textcolor{keywordflow}{return} q;}
\DoxyCodeLine{1738 \}}
\DoxyCodeLine{1739 }
\DoxyCodeLine{1740 }
\DoxyCodeLine{1746 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
