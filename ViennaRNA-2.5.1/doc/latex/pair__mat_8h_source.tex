\hypertarget{pair__mat_8h_source}{}\doxysection{pair\+\_\+mat.\+h}
\label{pair__mat_8h_source}\index{ViennaRNA/pair\_mat.h@{ViennaRNA/pair\_mat.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef VIENNA\_RNA\_PACKAGE\_PAIR\_MAT\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define VIENNA\_RNA\_PACKAGE\_PAIR\_MAT\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <ctype.h>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{utils_2basic_8h}{ViennaRNA/utils/basic.h}}>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{fold__vars_8h}{ViennaRNA/fold\_vars.h}}>}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#define NBASES 8}}
\DoxyCodeLine{9 \textcolor{comment}{/*@notnull@*/}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef INLINE}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\# ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#  define INLINE inline}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\# else}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#  define INLINE}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\# endif}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char} Law\_and\_Order[]         = \textcolor{stringliteral}{"{}\_ACGUTXKI"{}};}
\DoxyCodeLine{20 \textcolor{keyword}{static} \textcolor{keywordtype}{int}        BP\_pair[NBASES][NBASES] =}
\DoxyCodeLine{21   \textcolor{comment}{/* \_  A  C  G  U  X  K  I */}}
\DoxyCodeLine{22 \{ \{ 0, 0, 0, 0, 0, 0, 0, 0 \},}
\DoxyCodeLine{23   \{ 0, 0, 0, 0, 5, 0, 0, 5 \},}
\DoxyCodeLine{24   \{ 0, 0, 0, 1, 0, 0, 0, 0 \},}
\DoxyCodeLine{25   \{ 0, 0, 2, 0, 3, 0, 0, 0 \},}
\DoxyCodeLine{26   \{ 0, 6, 0, 4, 0, 0, 0, 6 \},}
\DoxyCodeLine{27   \{ 0, 0, 0, 0, 0, 0, 2, 0 \},}
\DoxyCodeLine{28   \{ 0, 0, 0, 0, 0, 1, 0, 0 \},}
\DoxyCodeLine{29   \{ 0, 6, 0, 0, 5, 0, 0, 0 \} \};}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{preprocessor}{\#define MAXALPHA 20       }\textcolor{comment}{/* maximal length of alphabet */}\textcolor{preprocessor}{}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{static} \textcolor{keywordtype}{short}  alias[\mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}} + 1];}
\DoxyCodeLine{34 \textcolor{keyword}{static} \textcolor{keywordtype}{int}    pair[\mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}} + 1][\mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}} + 1];}
\DoxyCodeLine{35 \textcolor{comment}{/* rtype[pair[i][j]]:=pair[j][i] */}}
\DoxyCodeLine{36 \textcolor{keyword}{static} \textcolor{keywordtype}{int}    rtype[8] = \{}
\DoxyCodeLine{37   0, 2, 1, 4, 3, 6, 5, 7}
\DoxyCodeLine{38 \};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#pragma omp threadprivate(Law\_and\_Order, BP\_pair, alias, pair, rtype)}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{/* for backward compatibility */}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#define ENCODE(c) encode\_char(c)}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{keyword}{static} INLINE \textcolor{keywordtype}{int}}
\DoxyCodeLine{48 encode\_char(\textcolor{keywordtype}{char} c)}
\DoxyCodeLine{49 \{}
\DoxyCodeLine{50   \textcolor{comment}{/* return numerical representation of base used e.g. in pair[][] */}}
\DoxyCodeLine{51   \textcolor{keywordtype}{int} code;}
\DoxyCodeLine{52 }
\DoxyCodeLine{53   c = toupper(c);}
\DoxyCodeLine{54 }
\DoxyCodeLine{55   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_gafb1ef1166da85092ae8a325e02dcae71}{energy\_set}} > 0) \{}
\DoxyCodeLine{56     code = (int)(c -\/ \textcolor{charliteral}{'A'}) + 1;}
\DoxyCodeLine{57   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{58     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *pos;}
\DoxyCodeLine{59     pos = strchr(Law\_and\_Order, c);}
\DoxyCodeLine{60     \textcolor{keywordflow}{if} (pos == NULL)}
\DoxyCodeLine{61       code = 0;}
\DoxyCodeLine{62     \textcolor{keywordflow}{else}}
\DoxyCodeLine{63       code = (int)(pos -\/ Law\_and\_Order);}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     \textcolor{keywordflow}{if} (code > 5)}
\DoxyCodeLine{66       code = 0;}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{keywordflow}{if} (code > 4)}
\DoxyCodeLine{69       code-\/-\/;           \textcolor{comment}{/* make T and U equivalent */}}
\DoxyCodeLine{70   \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72   \textcolor{keywordflow}{return} code;}
\DoxyCodeLine{73 \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 }
\DoxyCodeLine{76 \textcolor{comment}{/*@+boolint +charint@*/}}
\DoxyCodeLine{77 \textcolor{comment}{/*@null@*/}}
\DoxyCodeLine{78 \textcolor{keyword}{extern} \textcolor{keywordtype}{char} *\mbox{\hyperlink{group__model__details_ga2695d91cc535d09c2eae5c3884e2ec64}{nonstandards}};}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{keyword}{static} INLINE \textcolor{keywordtype}{void}}
\DoxyCodeLine{81 make\_pair\_matrix(\textcolor{keywordtype}{void})}
\DoxyCodeLine{82 \{}
\DoxyCodeLine{83   \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{84 }
\DoxyCodeLine{85   \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_gafb1ef1166da85092ae8a325e02dcae71}{energy\_set}} == 0) \{}
\DoxyCodeLine{86     \textcolor{keywordflow}{for} (i = 0; i < 5; i++)}
\DoxyCodeLine{87       alias[i] = (\textcolor{keywordtype}{short})i;}
\DoxyCodeLine{88     alias[5]  = 3;  \textcolor{comment}{/* X <-\/> G */}}
\DoxyCodeLine{89     alias[6]  = 2;  \textcolor{comment}{/* K <-\/> C */}}
\DoxyCodeLine{90     alias[7]  = 0;  \textcolor{comment}{/* I <-\/> default base '@' */}}
\DoxyCodeLine{91     \textcolor{keywordflow}{for} (i = 0; i < NBASES; i++)}
\DoxyCodeLine{92       \textcolor{keywordflow}{for} (j = 0; j < NBASES; j++)}
\DoxyCodeLine{93         pair[i][j] = BP\_pair[i][j];}
\DoxyCodeLine{94     \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_gabf380d09e4f1ab94fc6af57cf0ad5d32}{noGU}})}
\DoxyCodeLine{95       pair[3][4] = pair[4][3] = 0;}
\DoxyCodeLine{96 }
\DoxyCodeLine{97     \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_ga2695d91cc535d09c2eae5c3884e2ec64}{nonstandards}} != NULL) \{}
\DoxyCodeLine{98       \textcolor{comment}{/* allow nonstandard bp's */}}
\DoxyCodeLine{99       \textcolor{keywordflow}{for} (i = 0; i < (int)strlen(\mbox{\hyperlink{group__model__details_ga2695d91cc535d09c2eae5c3884e2ec64}{nonstandards}}); i += 2)}
\DoxyCodeLine{100         pair[encode\_char(\mbox{\hyperlink{group__model__details_ga2695d91cc535d09c2eae5c3884e2ec64}{nonstandards}}[i])]}
\DoxyCodeLine{101         [encode\_char(\mbox{\hyperlink{group__model__details_ga2695d91cc535d09c2eae5c3884e2ec64}{nonstandards}}[i + 1])] = 7;}
\DoxyCodeLine{102     \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104     \textcolor{keywordflow}{for} (i = 0; i < NBASES; i++)}
\DoxyCodeLine{105       \textcolor{keywordflow}{for} (j = 0; j < NBASES; j++)}
\DoxyCodeLine{106         rtype[pair[i][j]] = pair[j][i];}
\DoxyCodeLine{107   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{108     \textcolor{keywordflow}{for} (i = 0; i <= \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; i++)}
\DoxyCodeLine{109       \textcolor{keywordflow}{for} (j = 0; j <= \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; j++)}
\DoxyCodeLine{110         pair[i][j] = 0;}
\DoxyCodeLine{111     \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_gafb1ef1166da85092ae8a325e02dcae71}{energy\_set}} == 1) \{}
\DoxyCodeLine{112       \textcolor{keywordflow}{for} (i = 1; i < \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; ) \{}
\DoxyCodeLine{113         alias[i++]  = 3;      \textcolor{comment}{/* A <-\/> G */}}
\DoxyCodeLine{114         alias[i++]  = 2;      \textcolor{comment}{/* B <-\/> C */}}
\DoxyCodeLine{115       \}}
\DoxyCodeLine{116       \textcolor{keywordflow}{for} (i = 1; i < \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; i++) \{}
\DoxyCodeLine{117         pair[i][i + 1] = 2;       \textcolor{comment}{/* AB <-\/> GC */}}
\DoxyCodeLine{118         i++;}
\DoxyCodeLine{119         pair[i][i -\/ 1] = 1;       \textcolor{comment}{/* BA <-\/> CG */}}
\DoxyCodeLine{120       \}}
\DoxyCodeLine{121     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_gafb1ef1166da85092ae8a325e02dcae71}{energy\_set}} == 2) \{}
\DoxyCodeLine{122       \textcolor{keywordflow}{for} (i = 1; i < \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; ) \{}
\DoxyCodeLine{123         alias[i++]  = 1;      \textcolor{comment}{/* A <-\/> A*/}}
\DoxyCodeLine{124         alias[i++]  = 4;      \textcolor{comment}{/* B <-\/> U */}}
\DoxyCodeLine{125       \}}
\DoxyCodeLine{126       \textcolor{keywordflow}{for} (i = 1; i < \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; i++) \{}
\DoxyCodeLine{127         pair[i][i + 1] = 5;       \textcolor{comment}{/* AB <-\/> AU */}}
\DoxyCodeLine{128         i++;}
\DoxyCodeLine{129         pair[i][i -\/ 1] = 6;       \textcolor{comment}{/* BA <-\/> UA */}}
\DoxyCodeLine{130       \}}
\DoxyCodeLine{131     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{group__model__details_gafb1ef1166da85092ae8a325e02dcae71}{energy\_set}} == 3) \{}
\DoxyCodeLine{132       \textcolor{keywordflow}{for} (i = 1; i < \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}} -\/ 2; ) \{}
\DoxyCodeLine{133         alias[i++]  = 3;    \textcolor{comment}{/* A <-\/> G */}}
\DoxyCodeLine{134         alias[i++]  = 2;    \textcolor{comment}{/* B <-\/> C */}}
\DoxyCodeLine{135         alias[i++]  = 1;    \textcolor{comment}{/* C <-\/> A */}}
\DoxyCodeLine{136         alias[i++]  = 4;    \textcolor{comment}{/* D <-\/> U */}}
\DoxyCodeLine{137       \}}
\DoxyCodeLine{138       \textcolor{keywordflow}{for} (i = 1; i < \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}} -\/ 2; i++) \{}
\DoxyCodeLine{139         pair[i][i + 1] = 2;     \textcolor{comment}{/* AB <-\/> GC */}}
\DoxyCodeLine{140         i++;}
\DoxyCodeLine{141         pair[i][i -\/ 1] = 1;     \textcolor{comment}{/* BA <-\/> CG */}}
\DoxyCodeLine{142         i++;}
\DoxyCodeLine{143         pair[i][i + 1] = 5;     \textcolor{comment}{/* CD <-\/> AU */}}
\DoxyCodeLine{144         i++;}
\DoxyCodeLine{145         pair[i][i -\/ 1] = 6;     \textcolor{comment}{/* DC <-\/> UA */}}
\DoxyCodeLine{146       \}}
\DoxyCodeLine{147     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{148       \mbox{\hyperlink{group__message__utils_ga36b35be01d7f36cf7f59c245eee628d1}{vrna\_message\_error}}(\textcolor{stringliteral}{"{}What energy\_set are YOU using??"{}});}
\DoxyCodeLine{149     \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151     \textcolor{keywordflow}{for} (i = 0; i <= \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; i++)}
\DoxyCodeLine{152       \textcolor{keywordflow}{for} (j = 0; j <= \mbox{\hyperlink{group__model__details_ga05a5ffe718aa431d97419a12fb082379}{MAXALPHA}}; j++)}
\DoxyCodeLine{153         rtype[pair[i][j]] = pair[j][i];}
\DoxyCodeLine{154   \}}
\DoxyCodeLine{155 \}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157 }
\DoxyCodeLine{158 \textcolor{keyword}{static} INLINE \textcolor{keywordtype}{short} *}
\DoxyCodeLine{159 encode\_sequence(\textcolor{keyword}{const} \textcolor{keywordtype}{char}  *sequence,}
\DoxyCodeLine{160                 \textcolor{keywordtype}{short}       how)}
\DoxyCodeLine{161 \{}
\DoxyCodeLine{162   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  i, l = (\textcolor{keywordtype}{unsigned} int)strlen(sequence);}
\DoxyCodeLine{163   \textcolor{keywordtype}{short}         *S = (\textcolor{keywordtype}{short} *)\mbox{\hyperlink{group__utils_gafae44c31c8772450d6c674a582be3e3c}{vrna\_alloc}}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{short}) * (l + 2));}
\DoxyCodeLine{164 }
\DoxyCodeLine{165   \textcolor{keywordflow}{switch} (how) \{}
\DoxyCodeLine{166     \textcolor{comment}{/* standard encoding as always used for S */}}
\DoxyCodeLine{167     \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{168       \textcolor{keywordflow}{for} (i = 1; i <= l; i++)    \textcolor{comment}{/* make numerical encoding of sequence */}}
\DoxyCodeLine{169         S[i] = (\textcolor{keywordtype}{short})encode\_char(sequence[i -\/ 1]);}
\DoxyCodeLine{170       S[l + 1]  = S[1];}
\DoxyCodeLine{171       S[0]      = (short)l;}
\DoxyCodeLine{172       \textcolor{keywordflow}{break};}
\DoxyCodeLine{173     \textcolor{comment}{/* encoding for mismatches of nostandard bases (normally used for S1) */}}
\DoxyCodeLine{174     \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{175       \textcolor{keywordflow}{for} (i = 1; i <= l; i++)}
\DoxyCodeLine{176         S[i] = alias[(\textcolor{keywordtype}{short})encode\_char(sequence[i -\/ 1])];}
\DoxyCodeLine{177       S[l + 1]  = S[1];}
\DoxyCodeLine{178       S[0]      = S[l];}
\DoxyCodeLine{179       \textcolor{keywordflow}{break};}
\DoxyCodeLine{180   \}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182   \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{183 \}}
\DoxyCodeLine{184 }
\DoxyCodeLine{185 }
\DoxyCodeLine{186 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* VIENNA\_RNA\_PACKAGE\_PAIR\_MAT\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
