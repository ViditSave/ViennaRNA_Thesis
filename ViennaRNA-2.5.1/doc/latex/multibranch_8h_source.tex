\hypertarget{multibranch_8h_source}{}\doxysection{multibranch.\+h}
\label{multibranch_8h_source}\index{ViennaRNA/loops/multibranch.h@{ViennaRNA/loops/multibranch.h}}
\mbox{\hyperlink{multibranch_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef VIENNA\_RNA\_PACKAGE\_LOOPS\_MULTIBRANCH\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define VIENNA\_RNA\_PACKAGE\_LOOPS\_MULTIBRANCH\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{utils_2basic_8h}{ViennaRNA/utils/basic.h}}>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{datastructures_2basic_8h}{ViennaRNA/datastructures/basic.h}}>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{fold__compound_8h}{ViennaRNA/fold\_compound.h}}>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{params_2basic_8h}{ViennaRNA/params/basic.h}}>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#ifdef VRNA\_WARN\_DEPRECATED}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\# if defined(DEPRECATED)}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#   undef DEPRECATED}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\# endif}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\# if defined(\_\_clang\_\_)}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#  define DEPRECATED(func, msg) func \_\_attribute\_\_ ((deprecated("{}"{}}, msg)))}
\DoxyCodeLine{15 \textcolor{preprocessor}{\# elif defined(\_\_GNUC\_\_)}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#  define DEPRECATED(func, msg) func \_\_attribute\_\_ ((deprecated(msg)))}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\# else}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#  define DEPRECATED(func, msg) func}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\# endif}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\# define DEPRECATED(func, msg) func}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\# define INLINE inline}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\# define INLINE}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{29 }
\DoxyCodeLine{54 \textcolor{keywordtype}{int}}
\DoxyCodeLine{55 \mbox{\hyperlink{group__eval__loops__mb_ga91af6d5fcb0aef243a4071cf9e718020}{vrna\_E\_mb\_loop\_stack}}(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}} *fc,}
\DoxyCodeLine{56                      \textcolor{keywordtype}{int}                  i,}
\DoxyCodeLine{57                      \textcolor{keywordtype}{int}                  j);}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keywordtype}{int}}
\DoxyCodeLine{61 vrna\_E\_mb\_loop\_fast(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *fc,}
\DoxyCodeLine{62                     \textcolor{keywordtype}{int}                   i,}
\DoxyCodeLine{63                     \textcolor{keywordtype}{int}                   j,}
\DoxyCodeLine{64                     \textcolor{keywordtype}{int}                   *dmli1,}
\DoxyCodeLine{65                     \textcolor{keywordtype}{int}                   *dmli2);}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{keywordtype}{int}}
\DoxyCodeLine{69 E\_ml\_rightmost\_stem(\textcolor{keywordtype}{int}                   i,}
\DoxyCodeLine{70                     \textcolor{keywordtype}{int}                   j,}
\DoxyCodeLine{71                     \mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *fc);}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 }
\DoxyCodeLine{74 \textcolor{keywordtype}{int}}
\DoxyCodeLine{75 vrna\_E\_ml\_stems\_fast(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}} *fc,}
\DoxyCodeLine{76                      \textcolor{keywordtype}{int}                  i,}
\DoxyCodeLine{77                      \textcolor{keywordtype}{int}                  j,}
\DoxyCodeLine{78                      \textcolor{keywordtype}{int}                  *fmi,}
\DoxyCodeLine{79                      \textcolor{keywordtype}{int}                  *dmli);}
\DoxyCodeLine{80 }
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{comment}{/* End basic interface */}}
\DoxyCodeLine{98 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }vrna\_mx\_pf\_aux\_ml\_s *\mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}};}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{102 vrna\_exp\_E\_mb\_loop\_fast(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *fc,}
\DoxyCodeLine{103                         \textcolor{keywordtype}{int}                   i,}
\DoxyCodeLine{104                         \textcolor{keywordtype}{int}                   j,}
\DoxyCodeLine{105                         \mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}}   aux\_mx);}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}}}
\DoxyCodeLine{109 vrna\_exp\_E\_ml\_fast\_init(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}} *fc);}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 }
\DoxyCodeLine{112 \textcolor{keywordtype}{void}}
\DoxyCodeLine{113 vrna\_exp\_E\_ml\_fast\_rotate(\mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}} aux\_mx);}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 }
\DoxyCodeLine{116 \textcolor{keywordtype}{void}}
\DoxyCodeLine{117 vrna\_exp\_E\_ml\_fast\_free(\mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}} aux\_mx);}
\DoxyCodeLine{118 }
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{keyword}{const} \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}} *}
\DoxyCodeLine{121 vrna\_exp\_E\_ml\_fast\_qqm(\mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}} aux\_mx);}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 }
\DoxyCodeLine{124 \textcolor{keyword}{const} \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}} *}
\DoxyCodeLine{125 vrna\_exp\_E\_ml\_fast\_qqm1(\mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}} aux\_mx);}
\DoxyCodeLine{126 }
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{129 vrna\_exp\_E\_ml\_fast(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}} *fc,}
\DoxyCodeLine{130                    \textcolor{keywordtype}{int}                  i,}
\DoxyCodeLine{131                    \textcolor{keywordtype}{int}                  j,}
\DoxyCodeLine{132                    \mbox{\hyperlink{group__eval__loops__mb_ga39a8cc1385dcb542a60a9393cde6a1e3}{vrna\_mx\_pf\_aux\_ml\_t}}  aux\_mx);}
\DoxyCodeLine{133 }
\DoxyCodeLine{134 }
\DoxyCodeLine{135 \textcolor{comment}{/* End partition function interface */}}
\DoxyCodeLine{163 \textcolor{keywordtype}{int}}
\DoxyCodeLine{164 \mbox{\hyperlink{group__mfe__backtracking_ga5b62d56c9d47c1e8792b02cd6b95e78b}{vrna\_BT\_mb\_loop}}(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *fc,}
\DoxyCodeLine{165                 \textcolor{keywordtype}{int}                   *i,}
\DoxyCodeLine{166                 \textcolor{keywordtype}{int}                   *j,}
\DoxyCodeLine{167                 \textcolor{keywordtype}{int}                   *k,}
\DoxyCodeLine{168                 \textcolor{keywordtype}{int}                   en,}
\DoxyCodeLine{169                 \textcolor{keywordtype}{int}                   *component1,}
\DoxyCodeLine{170                 \textcolor{keywordtype}{int}                   *component2);}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \textcolor{keywordtype}{int}}
\DoxyCodeLine{174 vrna\_BT\_mb\_loop\_split(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}  *fc,}
\DoxyCodeLine{175                       \textcolor{keywordtype}{int}                   *i,}
\DoxyCodeLine{176                       \textcolor{keywordtype}{int}                   *j,}
\DoxyCodeLine{177                       \textcolor{keywordtype}{int}                   *k,}
\DoxyCodeLine{178                       \textcolor{keywordtype}{int}                   *l,}
\DoxyCodeLine{179                       \textcolor{keywordtype}{int}                   *component1,}
\DoxyCodeLine{180                       \textcolor{keywordtype}{int}                   *component2,}
\DoxyCodeLine{181                       \mbox{\hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}}       *bp\_stack,}
\DoxyCodeLine{182                       \textcolor{keywordtype}{int}                   *stack\_count);}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 }
\DoxyCodeLine{190 \textcolor{preprocessor}{\#ifndef VRNA\_DISABLE\_BACKWARD\_COMPATIBILITY}}
\DoxyCodeLine{191 }
\DoxyCodeLine{216 PRIVATE INLINE \textcolor{keywordtype}{int}}
\DoxyCodeLine{217 E\_MLstem(\textcolor{keywordtype}{int}          type,}
\DoxyCodeLine{218          \textcolor{keywordtype}{int}          si1,}
\DoxyCodeLine{219          \textcolor{keywordtype}{int}          sj1,}
\DoxyCodeLine{220          \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}} *P)}
\DoxyCodeLine{221 \{}
\DoxyCodeLine{222   \textcolor{keywordtype}{int} energy = 0;}
\DoxyCodeLine{223 }
\DoxyCodeLine{224   \textcolor{keywordflow}{if} (si1 >= 0 \&\& sj1 >= 0)}
\DoxyCodeLine{225     energy += P-\/>mismatchM[type][si1][sj1];}
\DoxyCodeLine{226   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (si1 >= 0)}
\DoxyCodeLine{227     energy += P-\/>dangle5[type][si1];}
\DoxyCodeLine{228   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sj1 >= 0)}
\DoxyCodeLine{229     energy += P-\/>dangle3[type][sj1];}
\DoxyCodeLine{230 }
\DoxyCodeLine{231   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{232     energy += P-\/>TerminalAU;}
\DoxyCodeLine{233 }
\DoxyCodeLine{234   energy += P-\/>MLintern[type];}
\DoxyCodeLine{235 }
\DoxyCodeLine{236   \textcolor{keywordflow}{return} energy;}
\DoxyCodeLine{237 \}}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 }
\DoxyCodeLine{246 PRIVATE INLINE \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{247 exp\_E\_MLstem(\textcolor{keywordtype}{int}              type,}
\DoxyCodeLine{248              \textcolor{keywordtype}{int}              si1,}
\DoxyCodeLine{249              \textcolor{keywordtype}{int}              sj1,}
\DoxyCodeLine{250              \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}} *P)}
\DoxyCodeLine{251 \{}
\DoxyCodeLine{252   \textcolor{keywordtype}{double} energy = 1.0;}
\DoxyCodeLine{253 }
\DoxyCodeLine{254   \textcolor{keywordflow}{if} (si1 >= 0 \&\& sj1 >= 0)}
\DoxyCodeLine{255     energy = P-\/>expmismatchM[type][si1][sj1];}
\DoxyCodeLine{256   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (si1 >= 0)}
\DoxyCodeLine{257     energy = P-\/>expdangle5[type][si1];}
\DoxyCodeLine{258   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sj1 >= 0)}
\DoxyCodeLine{259     energy = P-\/>expdangle3[type][sj1];}
\DoxyCodeLine{260 }
\DoxyCodeLine{261   \textcolor{keywordflow}{if} (type > 2)}
\DoxyCodeLine{262     energy *= P-\/>expTermAU;}
\DoxyCodeLine{263 }
\DoxyCodeLine{264   energy *= P-\/>expMLintern[type];}
\DoxyCodeLine{265   \textcolor{keywordflow}{return} (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})energy;}
\DoxyCodeLine{266 \}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 }
\DoxyCodeLine{269 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{270 }
\DoxyCodeLine{275 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
